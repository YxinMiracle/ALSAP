Each O
DLL O
includes O
a O
hardcoded O
, O
default O
configuration O
. O

Prioxer O
has O
been O
linked O
to O
other O
2011 O
attacks O
on O
South O
Korea O
. O

The O
spike O
in O
August O
and O
September O
2012 O
is O
mostly O
related O
to O
a O
large O
scale O
attack O
against O
a O
global O
oil O
company O
. O

This O
scheme O
was O
implemented O
in O
April O
2014 O
. O

A B-Entity
Hello I-Entity
packet I-Entity
is B-Action
then I-Action
sent I-Action
: O
The B-Entity
bot I-Entity
then O
repeatedly O
sends B-Action
GET B-Entity
requests I-Entity
on B-Modifier
'' B-Entity
/httpdocs/mm/ I-Entity
< I-Entity
botid I-Entity
> I-Entity
/ComMand.sec I-Entity
'' I-Entity
to O
retrieve B-Action
remote B-Entity
commands I-Entity
. O

As O
noted O
above O
, O
North O
Korea O
views O
the O
U.S. O
and O
South O
Korea O
as O
its O
primary O
adversaries O
. O

CloudMe O
has O
shared O
a O
great O
deal O
of O
log O
information O
related O
to O
this O
attack O
. O

It O
is O
unknown O
if O
this O
is O
the O
same O
Muhammad O
Naseer O
that O
is O
associated O
with O
VPSNOC O
's O
parent O
company O
Digital O
Linx O
, O
the O
Pakistan-based O
service O
provider O
which O
hosted O
the O
original O
BITTERBUG O
malware O
. O

Note O
that O
even O
if O
the O
ad O
libraries O
have O
a O
correct O
and O
rigorous O
implementation O
, O
the O
SSL O
library O
itself O
may O
contain O
serious O
vulnerabilities O
that O
can O
be O
exploited O
by O
MITM O
attacks O
, O
. O

North O
Korea O
had O
used O
game O
downloads O
to O
infect O
100,000 O
South O
Korean O
machines O
for O
a O
botnet O
used O
to O
launch O
a O
distributed O
denial O
of O
service O
( O
DDoS O
) O
attack O
against O
Incheon O
Airport O
. O

We O
call O
this O
backdoor O
CHOPSTICK O
, O
a O
somewhat O
ironic O
name O
that O
comes O
from O
our O
semi-random O
name O
generator O
. O

The B-Entity
dropped I-Entity
DLL I-Entity
( I-Entity
MD5 I-Entity
: I-Entity
47619fca20895abc83807321cbb80a3d I-Entity
) I-Entity
itself I-Entity
contains B-Action
functionality B-Entity
that I-Entity
is I-Entity
typical I-Entity
of I-Entity
a I-Entity
Remote I-Entity
Access I-Entity
Tool I-Entity
( I-Entity
RAT I-Entity
) I-Entity
which O
are O
commonly O
used B-Action
by O
PRC B-Entity
based I-Entity
actors I-Entity
in B-Modifier
data B-Entity
exfiltration I-Entity
attacks I-Entity
. O

An O
additional O
source O
of O
concern O
is O
that O
some O
countries O
have O
started O
to O
open O
the O
energy O
market O
for O
smaller O
private O
contributors O
. O

Once O
again O
, O
it O
is O
also O
interesting O
to O
point O
out O
the O
usage O
of O
Codepage O
1251 O
in O
the O
webshell O
, O
which O
is O
used O
to O
render O
Cyrillic O
characters O
. O

Commands B-Entity
are B-Action
sent I-Action
from B-Modifier
the B-Entity
C2 I-Entity
server I-Entity
to B-Modifier
the B-Entity
CORESHELL I-Entity
backdoor I-Entity
in B-Modifier
HTTP B-Entity
responses I-Entity
to I-Entity
the I-Entity
POST I-Entity
requests I-Entity
. O

On B-Modifier
64-bit B-Entity
versions I-Entity
of I-Entity
Windows I-Entity
Vista I-Entity
and I-Entity
above I-Entity
it B-Entity
behaves B-Action
differently B-Entity
. O

'' O
( O
June O
) O
 O
DarkSeoul O
DDoS O
and O
disk O
wiping O
malware O
targeting O
South O
Korean O
and O
U.S. O
government O
, O
media O
outlet O
, O
and O
financial O
websites O
. O

The O
remainder O
of O
this O
report O
gives O
a O
detailed O
explanation O
of O
how O
the O
two O
Snake O
architectures O
embed O
themselves O
in O
the O
target O
system O
and O
communicate O
with O
the O
outside O
world O
. O

CCProxy O
is O
a O
publicly O
available O
proxy O
server O
for O
Windows O
, O
which O
can O
handle O
a O
variety O
of O
protocols O
. O

The B-Entity
second I-Entity
method I-Entity
, O
which O
is O
gaining O
traction O
, O
is B-Action
watering B-Entity
hole I-Entity
attacks I-Entity
, O
where O
the B-Entity
attacker I-Entity
infects B-Action
a B-Entity
website I-Entity
that I-Entity
has I-Entity
a I-Entity
high I-Entity
likelihood I-Entity
of I-Entity
being I-Entity
visited I-Entity
by I-Entity
the I-Entity
intended I-Entity
victim I-Entity
. O

To O
verify O
this O
, O
we O
open O
up O
Wireshark O
and O
run O
the O
executable O
. O

We O
began O
our O
work O
when O
contacted O
by O
individuals O
con- O
cerned O
that O
a O
government O
might O
have O
targeted O
them O
for O
cyber- O
attacks O
. O

Right O
after O
that O
keystroke B-Entity
generation I-Entity
thread I-Entity
is B-Action
terminated I-Action
and O
the O
module O
continues O
normal O
execution O
as O
if O
«bdagent.exe» O
was O
not O
running O
. O

Further O
, O
because O
the B-Entity
malware I-Entity
sends B-Action
data B-Entity
captured I-Entity
by I-Entity
the I-Entity
malware I-Entity
to B-Modifier
an B-Entity
e-mail I-Entity
address I-Entity
, O
it O
does O
not O
require O
that O
the O
attackers O
maintain O
a O
command-and-control O
server O
online O
. O

We O
do O
not O
believe O
that O
this O
organization O
was O
involved O
in O
the O
development O
or O
modification O
of O
CCProxy O
, O
but O
they O
have O
been O
observed O
using O
it O
. O

This O
could O
easily O
grow O
to O
petabytes O
of O
data O
that O
needs O
to O
be O
safely O
stored O
and O
managed O
. O

Digital O
Appendix O
1 O
contains O
additional O
research O
collateral O
collected O
when O
conducting O
Operation O
Arachnophobia O
research O
. O

The O
attacks O
are O
simple O
to O
carry O
out O
. O

Specifically O
, O
17bc9d2a640da75db6cbb66e5898feb1 O
is O
a O
PlugX O
variant O
signed O
by O
the O
QTI O
International O
certificate O
. O

In O
other O
words O
, O
there O
was O
no O
significant O
identifying O
information O
in O
the O
form O
of O
an O
OSINT O
trail O
left O
behind O
by O
the O
actors O
. O

The O
handler O
class O
is O
responsible O
for O
parsing O
the O
remainder O
of O
the O
command O
. O

This O
attack O
also O
coincided O
with O
the O
timing O
of O
the O
annual O
joint O
U.S. O
– O
South O
Korea O
military O
exercises O
. O

The O
PLA O
's O
GSD O
Third O
Department O
is O
generally O
acknowledged O
to O
be O
China O
's O
premier O
Signals O
Intelligence O
( O
SIGINT O
) O
collection O
and O
analysis O
agency O
, O
and O
the O
12th O
Bureau O
Unit O
61486 O
, O
headquartered O
in O
Shanghai O
, O
supports O
China O
's O
space O
surveillance O
network O
. O

Cylance O
products O
such O
as O
CylancePROTECT O
prevent O
the O
most O
advanced O
attacks O
in O
the O
world O
without O
signatures O
or O
sandboxing O
in O
realtime O
on O
the O
endpoint O
. O

Additionally O
, O
this B-Entity
class I-Entity
implements O
launching B-Action
of O
specified B-Entity
executable I-Entity
files I-Entity
via B-Modifier
the B-Entity
CreateProcess I-Entity
( I-Entity
) I-Entity
API I-Entity
. O

The O
email O
screenshot O
( O
image1.png O
) O
from O
within O
the O
Tranchulas O
response O
demonstrated O
awareness O
of O
information O
that O
we O
initially O
withheld O
and O
later O
released O
in O
our O
blog O
post O
: O
one O
malware O
variant O
that O
contained O
a O
debug O
string O
with O
'' O
umairaziz27 O
'' O
the O
same O
username O
as O
a O
Tranchulas O
employee O
. O

We O
would O
advocate O
that O
this O
method O
is O
unwise O
when O
you O
want O
to O
stay O
furtive O
, O
and O
doing O
it O
from O
a O
c O
& O
c O
server O
is O
very O
surprising O
, O
to O
say O
the O
least O
. O

For O
more O
difficult O
targets O
, O
man-in-the-middle O
attacks O
can O
be O
used O
. O

Figure O
1 O
illustrates O
the O
infrastructure O
overlaps O
and O
connections O
we O
observed O
between O
the O
strategic O
Web O
compromise O
campaign O
leveraging O
the O
VFW O
's O
website O
, O
the O
DeputyDog O
, O
and O
the O
Ephemeral O
Hydra O
operations O
. O

A B-Entity
bug I-Entity
fix I-Entity
is B-Action
made I-Action
to B-Modifier
the B-Entity
keystroke I-Entity
logging I-Entity
method I-Entity
, O
and O
clipboard B-Entity
monitoring I-Entity
is B-Action
enabled I-Action
. O

The B-Entity
malware I-Entity
used I-Entity
in I-Entity
the I-Entity
March I-Entity
20 I-Entity
, I-Entity
2013 I-Entity
attacks I-Entity
were B-Action
wiper B-Entity
malware I-Entity
. O

'' O
The O
Chongryon O
are O
vital O
to O
North O
Korea O
's O
military O
budget O
, O
raising O
funds O
via O
weapons O
trafficking O
, O
drug O
trafficking O
, O
and O
other O
black O
market O
activities O
. O

In O
order O
to O
locate O
the O
embedded O
DLL O
, O
LoadEmbeddedImage O
will O
use O
the O
DecodeString O
function O
to O
decrypt O
the O
delimiter O
string O
( O
which O
is O
typically O
zzzzzzzzzz O
or O
yyyyyyyyyy O
) O
and O
then O
search O
the O
icon's O
resource O
memory O
for O
the O
delimiter O
string O
. O

The O
creators O
of O
the O
malware O
operate O
a O
working O
week O
, O
just O
like O
any O
other O
professional O
. O

] O
flnet O
[ O
. O

Here O
is O
an O
example O
of O
shortest O
possible O
valid O
server O
response O
: O
2 O
. O

Gen O
2.0 O
Alpha O
is O
a O
stand-alone O
Windows O
console O
executable O
that O
can O
run O
as O
a O
service O
executable O
. O

The B-Entity
emails I-Entity
all I-Entity
contained B-Action
malicious B-Entity
attachments I-Entity
. O

assembly O
. O

Since O
they O
specialize O
in O
knowing O
the O
location O
of O
their O
ad O
windows O
, O
they O
market O
those O
ad O
spaces O
to O
the O
actual O
advertisers O
and O
malvertisers O
, O
along O
with O
targeted O
demographics O
about O
the O
content O
pages O
, O
the O
visitors O
to O
the O
sites O
and O
more O
. O

This O
version O
targeted O
a O
major O
Saudi O
Arabian O
oil O
company O
. O

Political O
ties O
between O
Russia O
and O
North O
Korea O
have O
become O
stronger O
in O
recent O
months O
. O

In O
some O
of O
the O
emails O
, O
an O
additional O
CHM O
file O
with O
an O
old O
exploit O
was O
used O
in O
an O
effort O
to O
maximize O
the O
chances O
of O
a O
successful O
infection O
. O

Tranchulas O
claims O
to O
support O
'' O
national O
level O
cyber O
security O
programs O
'' O
and O
the O
development O
of O
offensive O
and O
defensive O
cyber O
capabilities O
. O

APT28 B-Entity
used B-Action
a B-Entity
lure I-Entity
document I-Entity
that O
installed B-Action
a B-Entity
SOURFACE I-Entity
downloader I-Entity
( O
further O
discussed O
in O
the O
Malware O
section O
) O
and O
contained B-Action
a B-Entity
listing I-Entity
of I-Entity
birthdays I-Entity
for I-Entity
members I-Entity
of I-Entity
a I-Entity
working I-Entity
group I-Entity
between I-Entity
the I-Entity
Georgian I-Entity
MOD I-Entity
and I-Entity
the I-Entity
U.S. I-Entity
defense I-Entity
contractor I-Entity
. O

Hence O
, O
they O
see O
the O
outside O
world O
as O
an O
inherently O
dangerous O
place O
. O

Module O
names O
corresponding O
to O
Outlook O
Express O
( O
msinm.exe O
) O
, O
Outlook O
( O
outlook.exe O
) O
, O
Internet O
Explorer O
( O
iexplore.exe O
) O
, O
and O
Firefox O
( O
firefox.exe O
) O
are O
used O
. O

This O
IP O
address O
was O
also O
observed O
in O
multiple O
software O
configurations O
. O

By O
exploiting O
and O
co-opting O
Afghan O
network O
infrastructure O
that O
is O
used O
by O
multiple O
ministerial O
level O
websites O
, O
Chinese B-Entity
intelligence I-Entity
services I-Entity
would O
be O
able O
to O
widely O
distribute B-Action
malicious B-Entity
payloads I-Entity
to B-Modifier
a B-Entity
variety I-Entity
of I-Entity
global I-Entity
targets I-Entity
using B-Modifier
Afghanistan B-Entity
's I-Entity
government I-Entity
websites I-Entity
as I-Entity
a I-Entity
topical I-Entity
and I-Entity
trusted I-Entity
distribution I-Entity
platform I-Entity
, O
exploiting O
a O
single O
hidden O
entry O
point O
. O

The B-Entity
next I-Entity
key I-Entity
to O
be B-Action
changed I-Action
is O
: O
HKEYLOCALMACHINE\\SOFTWARE\\Microsoft\\Windows O
NT\\CurrentVersion\\Svchost O
, O
which O
will O
have O
the B-Entity
'msupdate I-Entity
' I-Entity
key I-Entity
set B-Action
to B-Modifier
'msupdate B-Entity
' I-Entity
. O

• O
This O
campaign O
continues O
Iran O
's O
retaliation O
for O
Stuxnet O
, O
Duqu O
, O
and O
Flame O
. O

the O
malware O
will O
run O
on O
the O
system O
without O
any O
communication O
to O
C O
& O
C O
servers O
. O

In O
March O
, O
2014 O
, O
Microsoft O
published O
information O
about O
a O
new O
vulnerability O
in O
Rich O
Text O
Format O
( O
RTF O
) O
. O

In O
a O
similar O
fashion O
to O
the O
Android O
version O
, O
we O
find O
interesting O
strings O
there O
. O

Songun O
emphasizes O
the O
priority O
of O
the O
military O
in O
resource O
allocation O
and O
political O
and O
economic O
affairs O
. O

Citizen O
journalists O
in O
Ar-Raqqah O
were O
previously O
critical O
of O
arbitrary O
arrests O
carried O
out O
by O
non-ISIS O
groups O
in O
2013 O
. O

TinyZBot O
was O
developed O
with O
the O
clear O
intention O
of O
targeted O
campaigns O
. O

North O
Korea O
's O
foreign O
ministry O
also O
issued O
a O
statement O
that O
it O
perceived O
this O
exercise O
as O
a O
precursor O
to O
invasion O
and O
that O
the O
regime O
would O
respond O
with O
a O
'' O
strong O
military O
counteraction O
'' O
if O
the O
situation O
escalated O
. O

With O
plans O
to O
facilitate O
multilateral O
peace O
talks O
with O
the O
Taliban O
and O
establish O
major O
transportation O
projects O
which O
aim O
to O
bolster O
the O
Afghan O
economy O
, O
Beijing O
has O
been O
eyeing O
Afghanistan O
as O
part O
of O
its O
broader O
South O
Asian O
strategy O
. O

Windows O
allows O
WebDAV O
sessions O
to O
be O
mapped O
as O
network O
resources O
. O

The O
important O
take O
away O
from O
the O
evolution O
of O
Hikit O
is O
that O
the O
developers O
for O
Gen O
1 O
appear O
to O
have O
changed O
in O
late O
2011 O
and O
development O
of O
Gen O
2 O
has O
a O
several O
month O
overlap O
with O
the O
development O
and O
usage O
of O
Gen O
1 O
. O

Here O
's O
a O
look O
at O
one O
such O
account O
from O
CloudMe O
: O
The O
data O
from O
the O
account O
: O
The B-Entity
files I-Entity
stored I-Entity
in I-Entity
the I-Entity
randomly I-Entity
named I-Entity
folder I-Entity
were B-Action
uploaded I-Action
by O
the B-Entity
malware I-Entity
and O
contain B-Action
various B-Entity
things I-Entity
, I-Entity
such I-Entity
as I-Entity
system I-Entity
information I-Entity
, I-Entity
running I-Entity
processes I-Entity
and I-Entity
current I-Entity
username I-Entity
. O

At O
the O
time O
of O
writing O
the O
file O
had O
been O
downloaded O
only O
10 O
times O
This O
file O
is O
a O
self-extracting O
archive O
with O
an O
icon O
intended O
to O
suggest O
to O
the O
victim O
that O
it O
is O
itself O
a O
slideshow O
. O

During O
the O
workshop O
, O
basic O
penetration O
techniques O
and O
skills O
were O
presented O
. O

In O
this O
example O
the O
command O
byte O
is O
04 O
indicating O
the O
following O
bytes O
are O
shellcode O
. O

The B-Entity
malware I-Entity
deletes B-Action
all B-Entity
files I-Entity
on I-Entity
a I-Entity
computer I-Entity
and O
then O
deletes B-Action
the B-Entity
master I-Entity
boot I-Entity
record I-Entity
, O
rendering B-Action
the B-Entity
computer I-Entity
unusable B-Entity
. O

On O
the O
other O
hand O
, O
some B-Entity
at- I-Entity
tacks I-Entity
use B-Action
so-called B-Entity
'' I-Entity
lawful I-Entity
intercept I-Entity
'' I-Entity
trojans I-Entity
and O
related O
equip- O
ment O
, O
purportedly O
sold O
exclusively O
to O
governments O
by O
compa- O
nies O
like O
Gamma O
International O
and O
Hacking O
Team O
. O

This B-Entity
Javascript I-Entity
file I-Entity
is B-Action
a B-Entity
framework I-Entity
for I-Entity
reconnaissance I-Entity
that O
the O
attackers O
call O
'' O
Scanbox O
'' O
and O
includes O
some O
of O
the O
techniques O
we O
described O
in O
a O
previous O
blog O
post O
: O
The B-Entity
Scanbox I-Entity
framework I-Entity
first O
configures B-Action
the B-Entity
remote I-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
that I-Entity
it I-Entity
will I-Entity
use I-Entity
and O
collects B-Action
a B-Entity
small I-Entity
amount I-Entity
of I-Entity
information I-Entity
about B-Modifier
the B-Entity
victim I-Entity
that I-Entity
is I-Entity
visiting I-Entity
the I-Entity
compromised I-Entity
website I-Entity
including O
: O
Resulting O
in O
something O
like O
this O
: O
Before O
sending B-Action
the B-Entity
information I-Entity
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
, O
Scanbox B-Entity
encodes B-Action
and O
encrypts B-Action
the B-Entity
data I-Entity
with B-Modifier
the B-Entity
following I-Entity
function I-Entity
: O
Producing O
the O
following O
request O
: O
If O
we O
decrypt O
the O
data O
it O
translates O
to O
: O
After O
the O
first O
request O
, O
the B-Entity
framework I-Entity
contains O
several O
plugins O
to O
extract B-Action
different B-Entity
information I-Entity
from B-Modifier
the B-Entity
victim I-Entity
. O

) O
Neustar O
does O
provide O
a O
real-time O
bidding O
ad O
exchange O
, O
but O
their O
real O
market O
is O
IP O
intelligence O
that O
they O
sell O
to O
other O
advertising O
networks O
for O
the O
purposes O
of O
better O
targeting O
specific O
users O
. O

When O
a O
Windows O
kernel O
driver O
needs O
to O
allocate O
memory O
to O
store O
some O
type O
of O
data O
, O
it O
creates O
so O
called O
kernel O
pools O
. O

The O
name O
of O
the O
.LNK O

In O
addition O
, O
spear B-Entity
phishing I-Entity
messages I-Entity
were B-Action
used I-Action
to B-Modifier
compromise B-Entity
additional I-Entity
computers I-Entity
. O

Regin B-Entity
can O
be B-Action
distributed I-Action
with B-Modifier
various B-Entity
payload I-Entity
modules I-Entity
or O
receive B-Action
payload B-Entity
modules I-Entity
after B-Modifier
infection B-Entity
. O

By O
far O
, O
the O
public O
sector O
in O
Japan O
is O
the O
most O
targeted O
sector O
hit O
by O
Operation O
CloudyOmega O
. O

This O
binary O
file O
contains O
some O
of O
such O
pointers O
initialized O
, O
which O
corroborates O
the O
hypothesis O
that O
the B-Entity
file I-Entity
was B-Action
dumped I-Action
from B-Modifier
memory B-Entity
during O
a O
forensic O
analysis O
of O
a O
compromised O
system O
. O

Fortunately O
, O
Android O
Runtime O
offers O
another O
way O
to O
load O
Java O
Native O
Interface O
( O
JNI O
) O
code O
into O
the O
host O
app O
using O
Runtime.load O
( O
) O
. O

The O
actual O
break-in O
occurs O
during O
this O
phase O
. O

Members O
of O
this O
espionage O
network O
reportedly O
'' O
send O
more O
than O
$ O
100 O
million O
in O
cash O
per O
year O
to O
the O
regime O
and O
provide O
cover O
for O
spies O
. O

Operation O
Cleaver O
used O
a O
plagiarized O
version O
of O
a O
publicly O
available O
exploit O
for O
this O
vulnerability O
developed O
in O
Python O
. O

This O
occurs O
because O
automated O
malware O
is O
normally O
incapable O
of O
physically O
clicking O
an O
acceptance O
radial O
button O
. O

Some O
modules O
have O
artifacts O
which O
indicate O
the O
Carbon O
system O
is O
already O
at O
version O
3.x O
, O
although O
the O
exact O
Carbon O
system O
version O
is O
very O
rarely O
seen O
in O
samples O
: O
The O
author O
of O
the O
Carbon O
module O
above O
can O
be O
also O
seen O
in O
the O
code O
, O
as O
'' O
gilg O
'' O
, O
which O
also O
authored O
several O
other O
Turla O
modules O
. O

Email O
is O
the O
predominant O
infection O
vector O
used O
in O
this O
campaign O
. O

KCC O
has O
a O
vested O
interest O
in O
Linux O
research O
and O
is O
responsible O
for O
the O
development O
of O
North O
Korea O
's O
national O
operating O
system O
, O
Red O
Star O
OS O
, O
which O
is O
discussed O
in O
more O
detail O
below O
. O

During O
our O
research O
, O
we O
have O
also O
uncovered O
strong O
evidence O
suggesting O
that O
OnionDuke O
has O
been O
used O
in O
targeted O
attacks O
against O
European O
government O
agencies O
, O
although O
we O
have O
so O
far O
been O
unable O
to O
identify O
the O
infection O
vector O
( O
s O
) O
. O

It O
's O
estimated O
that O
Shamoon O
impacted O
over O
30,000 O
computer O
endpoints O
and O
cost O
the O
affected O
companies O
tens-of-thousands O
of O
hours O
recovering O
from O
the O
attacks O
. O

Similarly O
the O
system O
call O
hooking O
is O
less O
impressive O
after O
searching O
for O
'' O
IoAllocateMdl O
'' O
and O
'' O
cr0 O
'' O
( O
bbs.pediy O
. O

Gen O
2.3 O
is O
notable O
for O
its O
use O
of O
a O
legitimate O
SSL O
certificate O
as O
part O
of O
the O
handshake O
between O
the O
infected O
machine O
and O
the O
attacker O
's O
C2 O
. O

'' O
As O
the O
traditional O
western O
counterweight O
to O
the O
Soviet O
Union O
, O
Russia O
regards O
NATO O
, O
particularly O
NATO O
's O
eastward O
expansion O
, O
as O
a O
threat O
to O
Russia O
's O
strategic O
stability O
. O

'' O
They O
reportedly O
recorded O
12,473 O
of O
these O
touches O
in O
February O
2013 O
, O
11,000 O
of O
which O
were O
directed O
at O
a O
single O
financial O
institution O
. O

North O
Korea O
continues O
to O
be O
a O
master O
of O
propaganda O
and O
deception O
and O
leverages O
the O
cyber O
realm O
for O
psychological O
operations O
. O

This O
report O
is O
an O
attempt O
to O
deliver O
on O
that O
mission O
. O

In O
fact O
, O
oil O
and O
gas O
was O
a O
particular O
focal O
point O
for O
the O
Cleaver O
team O
, O
going O
after O
no O
less O
than O
nine O
of O
these O
companies O
around O
the O
world O
. O

You O
can O
see O
a O
preliminary O
copy O
of O
the O
report O
on O
this O
linkhttp O
: O
//tempsend O
[ O
DOT O
] O
com/ O
[ O
Redacted O
] O
With O
all O
respect O
[ O
Name O
Redacted O
] O
We O
are O
unsure O
why O
the O
attacker O
specifically O
mentions O
Canada O
in O
the O
email O
lure O
. O

The B-Entity
attacks I-Entity
, O
while O
sometimes O
incorporating B-Action
effective B-Entity
so- I-Entity
cial I-Entity
engineering I-Entity
, O
in O
general O
lack O
novel O
technical O
elements O
. O

The O
attack O
included O
an O
attempt O
to O
wipe O
JoongAng O
Ilbo O
's O
servers O
as O
well O
as O
a O
defacement O
depicting O
a O
laughing O
cat O
. O

] O
com O
, O
nextmedia O
[ O
. O

'' O
PittyTiger O
'' O
is O
a O
mutex O
used O
by O
the O
malware O
. O

Content O
returned O
from O
this O
request O
will O
be O
saved O
to O
a O
file O
, O
but O
then O
immediately O
deleted O
. O

As O
you O
can O
see O
, O
over O
90 O
% O
of O
it O
occurs O
in O
the O
top O
five O
countries O
: O
Japan O
, O
followed O
by O
Taiwan O
, O
China O
, O
Russia O
and O
Korea O
. O

Pitty O
Tiger O
is O
no O
exception O
, O
as O
detailed O
later O
in O
this O
report O
. O

In O
addition O
, O
documents O
can O
contain O
slack O
space O
in O
which O
old O
data O
remains O
. O

No O
further O
encryption O
of O
the O
data O
takes O
place O
. O

It O
allows O
the B-Entity
adversary I-Entity
to O
view B-Action
the B-Entity
main I-Entity
desktop I-Entity
graphically B-Entity
and O
control B-Action
the B-Entity
keyboard I-Entity
and O
mouse B-Entity
. O

Unit O
121 O
comprises O
both O
an O
intelligence O
component O
and O
an O
attack O
component O
. O

Valuable B-Entity
target I-Entity
data I-Entity
is B-Action
often I-Action
not I-Action
written I-Action
to B-Modifier
disk B-Entity
. O

This O
year O
, O
the O
actors O
behind O
NetTraveler O
celebrate O
10 O
years O
of O
activity O
. O

This B-Entity
would O
hinder B-Action
static B-Entity
analysis I-Entity
of I-Entity
CORESHELL I-Entity
behavior I-Entity
by B-Modifier
creating B-Entity
a I-Entity
large I-Entity
amount I-Entity
of I-Entity
unnecessary I-Entity
noise I-Entity
in I-Entity
the I-Entity
disassembly I-Entity
. O

Though O
none O
of O
this O
information O
is O
surprising O
, O
it O
further O
suggests O
that O
both O
Bhatti O
and O
Abunasar O
Khan O
work O
or O
worked O
for O
Digital O
Linx O
and O
VPSNOC O
and O
during O
that O
time O
were O
both O
located O
in O
Pakistan O
. O

This O
is O
an O
interesting O
claim O
, O
considering O
that O
attacks O
attributed O
to O
North O
Korea O
are O
usually O
routed O
through O
other O
countries O
. O

The B-Entity
binary I-Entity
also O
checks B-Action
a B-Entity
separate I-Entity
folder I-Entity
on I-Entity
the I-Entity
cloud I-Entity
service I-Entity
designated I-Entity
to I-Entity
contain I-Entity
new I-Entity
configuration I-Entity
information I-Entity
. O

Once O
new O
systems O
are O
identified O
the O
attacker O
will O
attempt O
to O
hop O
onto O
them O
as O
well O
. O

The O
first O
seven O
bytes O
are O
static O
, O
and O
are O
hard-coded O
in O
CHOPSTICK O
, O
while O
the O
last O
four O
bytes O
appear O
to O
be O
unique O
. O

Regardless O
of O
whether O
the O
registry O
launches O
the O
DLL O
or O
when O
another O
malware O
executable O
starts O
the O
DLL O
directly O
, O
the B-Entity
DLL I-Entity
is B-Action
launched I-Action
using B-Modifier
regsrv32.exe B-Entity
with B-Modifier
the B-Entity
/s I-Entity
( I-Entity
silent I-Entity
) I-Entity
option I-Entity
. O

We O
observed O
Real B-Entity
Time I-Entity
Ad I-Entity
bidding I-Entity
platforms I-Entity
, I-Entity
including I-Entity
OpenX I-Entity
, I-Entity
GoogleAds I-Entity
, I-Entity
Yahoo I-Entity
, I-Entity
AOL I-Entity
, I-Entity
and I-Entity
first-impression.com I-Entity
, O
fall O
victim O
to O
the O
ransomware O
malvertising O
scheme O
by O
unwittingly O
delivering B-Action
the B-Entity
CryptoWall I-Entity
2.0 I-Entity
ransomware I-Entity
ads I-Entity
. O

Stage B-Entity
1 I-Entity
is B-Action
the B-Entity
initial I-Entity
load I-Entity
point I-Entity
for I-Entity
the I-Entity
threat I-Entity
. O

In O
recent O
years O
, O
two O
primary O
factors O
have O
heavily O
influenced O
the O
current O
state O
of O
North O
Korea's O
relations O
with O
South O
Korea O
and O
her O
allies O
: O
the O
rise O
of O
the O
regime O
's O
leader O
Kim O
Jong O
Un O
and O
the O
inauguration O
of O
South O
Korean O
president O
Park O
Guen O
Hye O
. O

We O
were O
able O
to O
do O
some O
forensic O
work O
on O
a O
compromised O
Tera-EP O
TE-800 O
device O
and O
discovered O
another O
dimension O
of O
the O
attacker O
's O
infrastructure O
. O

com O
, O
vgriffins.com O
and O
my-server.co O
, O
which O
use O
P.O O
. O

The B-Entity
two I-Entity
computers I-Entity
FLY-THINK I-Entity
and I-Entity
50PZ80C-1DFDCB8 I-Entity
have O
used B-Action
distinct B-Entity
IP I-Entity
addresses I-Entity
to B-Modifier
connect B-Entity
to I-Entity
the I-Entity
c I-Entity
& I-Entity
c I-Entity
, O
yet O
some O
of O
these O
IP O
addresses O
come O
from O
the O
same O
IP O
range O
: O
We O
mapped O
these O
RDP O
connections O
to O
have O
a O
graphical O
view O
: O
We O
found O
that O
a O
member O
of O
this O
group O
of O
attackers O
used O
some O
tools O
on O
his O
own O
system O
, O
for O
testing O
purposes O
. O

The B-Entity
Loaders I-Entity
, O
upon B-Modifier
unloading B-Entity
, O
will O
call B-Action
the B-Entity
StopServer I-Entity
function I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
shut B-Entity
down I-Entity
the I-Entity
embedded I-Entity
DLL I-Entity
. O

The O
sectors O
follow O
( O
Table O
5 O
) O
. O

The O
Tranchulas O
employee O
, O
Hamza O
Qamar O
, O
that O
handled O
the O
response O
to O
our O
inquiry O
has O
a O
public O
LinkedIn O
profile O
that O
states O
that O
he O
'' O
Engaged O
in O
system O
and O
enterprise O
level O
network O
and O
Web O
application O
security O
testing O
for O
clients O
ranging O
from O
large O
federal O
agencies O
, O
DoD O
, O
and O
commercial O
clients O
. O

We O
speculate O
that O
if O
an O
attacker O
were O
interested O
in O
maintaining O
long-term O
surveillance O
of O
the O
activities O
of O
RSS O
they O
could O
have O
employed O
a O
RAT O
. O

In O
CloudAtlas O
it O
is O
used O
to O
compress O
the O
logs O
and O
to O
decompress O
the O
decrypted O
payload O
from O
the O
C O
& O
C O
servers O
, O
while O
in O
Red O
October O
the O
'' O
scheduler O
'' O
plugin O
uses O
it O
to O
decompress O
executable O
payloads O
from O
the O
C O
& O
C O
. O

– O
clearly O
randomized B-Action
in B-Modifier
order I-Modifier
to I-Modifier
avoid B-Entity
detection I-Entity
by I-Entity
name I-Entity
. O

There O
are O
other O
ways O
to O
obtain O
Android O
context O
, O
like O
reflecting O
to O
the O
private O
static O
context O
variable O
of O
WebView O
. O

The O
Cleaver O
team O
clearly O
modified O
the O
source O
code O
and O
compiled O
a O
new O
version O
. O

Once O
successful O
, O
the B-Entity
malware I-Entity
uploads B-Action
a B-Entity
copy I-Entity
of I-Entity
the I-Entity
wiper I-Entity
file I-Entity
'' I-Entity
taskhostXX.exe I-Entity
'' I-Entity
, O
changes B-Action
the B-Entity
file-time I-Entity
to B-Modifier
match B-Entity
that I-Entity
of I-Entity
the I-Entity
built-in I-Entity
file I-Entity
'' I-Entity
calc.exe I-Entity
'' I-Entity
, O
and O
starts B-Action
the B-Entity
remote I-Entity
process I-Entity
. O

North O
Korea O
has O
the O
capability O
to O
create O
an O
EMP O
. O

In O
addition O
, O
when O
freeing O
memory O
using O
ExFreePool O
( O
) O
, O
the B-Entity
driver I-Entity
zeroes B-Action
the B-Entity
content I-Entity
, O
probably O
to O
avoid B-Action
leaving B-Entity
traces I-Entity
in I-Entity
pool I-Entity
memory I-Entity
. O

It O
is O
believed O
he O
is O
the O
developer O
of O
the O
project O
Binder1 O
. O

] O
org O
previously O
resolved O
to O
58.64.199.27 O
. O

The O
malicious O
LinkedIn O
page O
launched O
a B-Entity
malware I-Entity
attack I-Entity
, O
infecting B-Action
the B-Entity
employees I-Entity
' I-Entity
computers I-Entity
and O
giving B-Action
the O
spies O
total B-Entity
control I-Entity
of I-Entity
their I-Entity
systems I-Entity
, O
allowing O
GCHQ B-Entity
to O
get O
deep O
inside O
Belgacom O
's O
networks O
to O
steal B-Action
data B-Entity
. O

Two O
years O
ago O
, O
we O
published O
our O
research O
into O
RedOctober O
, O
a O
complex O
cyber-espionage O
operation O
targeting O
diplomatic O
embassies O
worldwide O
. O

The O
trick O
is O
to O
target B-Action
the B-Entity
right I-Entity
victim I-Entity
and O
provide B-Action
it B-Entity
with B-Modifier
the B-Entity
right I-Entity
content I-Entity
, O
so O
that O
they B-Entity
will O
click B-Action
on B-Modifier
a B-Entity
link I-Entity
leading I-Entity
to I-Entity
drive-by I-Entity
download I-Entity
of I-Entity
a I-Entity
malware I-Entity
, O
or O
open B-Action
an B-Entity
attached I-Entity
file I-Entity
which I-Entity
will I-Entity
infect I-Entity
their I-Entity
computer I-Entity
. O

Mr. O
Khan O
deferred O
our O
request O
to O
Mr. O
Hamza O
Qamar O
, O
a O
Penetration O
Testing O
Team O
Lead O
at O
Tranchulas O
, O
who O
later O
responded O
with O
a O
simple O
denial O
that O
the O
email O
message O
had O
not O
been O
altered O
apart O
from O
blurring O
the O
name O
of O
the O
original O
sender O
. O

CrowdStrike O
Services O
is O
a O
wholly O
owned O
subsidiary O
of O
CrowdStrike O
responsible O
for O
proactively O
defending O
against O
and O
responding O
to O
cyber O
incidents O
with O
pre O
and O
post O
Incident O
Response O
services O
. O

The B-Entity
secondary I-Entity
payload I-Entity
in O
that O
case O
was B-Action
detected I-Action
as B-Modifier
Backdoor.APT.CookieCutter B-Entity
( I-Entity
aka I-Entity
Pirpi I-Entity
) I-Entity
and O
also O
named O
newnotepad.exe O
( O
MD5 O
8849538ef1c3471640230605c2623c67 O
) O
and O
connected B-Action
to B-Modifier
the B-Entity
known I-Entity
APT3 I-Entity
domains I-Entity
: O
The O
192.184.60.229 O
IP O
address O
seen O
in O
this O
current O
campaign O
also O
hosts O
securitywap O
[ O
. O

Examples O
of O
this O
activity O
include O
the O
Korean O
Asia-Pacific O
Committee O
and O
the O
Ethnic O
Reconciliation O
Council O
. O

Is O
an O
IP O
Address O
like O
a O
cookie O
? O
No O
, O
an O
IP O
address O
only O
identifies O
devices O
on O
a O
network O
. O

Three O
items O
were O
compiled O
on O
August O
18 O
, O
2014 O
. O

To O
be O
started B-Action
during B-Modifier
the B-Entity
boot I-Entity
process I-Entity
of I-Entity
the I-Entity
infected I-Entity
machine I-Entity
, O
the B-Entity
malware I-Entity
creates B-Action
the B-Entity
following I-Entity
registry I-Entity
key I-Entity
: O
This O
registry O
key O
is O
used O
to O
associate O
the O
library O
shdocvw.tlp O
to O
the O
object O
42aedc87-2188-41fd-b9a3-0c966feabec1 O
as O
previously O
explained O
in O
the O
article O
about O
COMpfun O
. O

If O
the O
attackers O
are O
only O
after O
information O
this O
phase O
might O
not O
happen O
at O
all O
. O

Our O
suspicions O
of O
Tranchulas O
' O
involvement O
in O
the O
activity O
began O
to O
mount O
, O
based O
on O
a O
series O
of O
events O
that O
occurred O
both O
before O
and O
after O
the O
release O
of O
our O
blog O
post O
. O

Cybercriminals O
are O
constantly O
evolving O
and O
adapting O
in O
their O
attempts O
to O
bypass O
computer O
network O
defenses O
. O

The O
malware O
files O
Files O
dropped O
by O
the O
malware O
Collected O
Information O
Files O
( O
unencrypted O
) O
Exfiltrated O
file O
( O
encrypted O
) O
Registry O
Keys O
Acknowledgements O
: O
We O
are O
grateful O
to O
Cyber O
Arabs O
and O
the O
Institute O
for O
War O
and O
Peace O
Reporting O
for O
their O
critical O
work O
and O
assistance O
. O

Monitor O
logs O
-- O
Maintain O
and O
actively O
monitor O
a O
centralized O
logging O
solution O
that O
keeps O
track O
of O
all O
anomalous O
and O
potentially O
malicious O
activity O
. O

employee O
's O
name O
'' O
. O

It O
supports O
up O
to O
1024 O
parallel O
connections O
. O

This O
command O
results O
in O
the B-Entity
DLL I-Entity
deleting B-Action
itself B-Entity
and O
terminating B-Action
the B-Entity
backdoor I-Entity
process I-Entity
. O

The B-Entity
second I-Entity
involved B-Action
specially B-Entity
crafted I-Entity
IP I-Entity
spy I-Entity
links I-Entity
and I-Entity
e-mails I-Entity
de- O
signed O
to O
reveal B-Action
the B-Entity
IP I-Entity
addresses I-Entity
of I-Entity
operators I-Entity
of I-Entity
pseudonymous I-Entity
accounts I-Entity
. O

] O
blankchair O
[ O
. O

We O
found O
several O
domains O
used O
by O
the O
Pitty O
Tiger O
group O
, O
the O
most O
interesting O
ones O
being O
detailed O
in O
this O
chapter O
. O

The O
North O
Korean O
Silibank O
homepage O
is O
silibank.net O
, O
and O
the O
Chinese O
homepage O
is O
silibank.com O
. O

The O
report O
illuminates O
a B-Entity
wide I-Entity
set I-Entity
of I-Entity
tools I-Entity
in O
use B-Action
by O
the B-Entity
actors I-Entity
, O
including B-Modifier
several B-Entity
Remote I-Entity
Access I-Entity
Tools I-Entity
( I-Entity
RATs I-Entity
) I-Entity
. O

There O
are O
two O
known O
Stage O
1 O
file O
names O
: O
These O
are O
kernel B-Entity
drivers I-Entity
that O
load B-Action
and I-Action
execute I-Action
Stage B-Entity
2 I-Entity
. O

This O
JAD O
file O
contained O
the O
locations O
of O
the O
two O
Blackberry O
*.COD O
binaries O
which O
we O
then O
could O
download O
directly O
. O

They O
have O
long O
desired O
power O
on O
the O
political O
stage O
, O
in O
particular O
in O
the O
fight O
for O
nuclear O
power O
autonomy O
. O

The O
same O
code O
was O
used O
by O
Agent.BTZ O
and O
also O
the O
dll O
loaded O
into O
userland O
during O
the O
Uroburos O
analysis O
. O

Own O
everybody O
. O

It O
is O
important O
to O
consider O
that O
corporate O
enterprises O
are O
not O
immune O
to O
this O
tactic O
, O
and O
this O
is O
not O
just O
a O
technique O
that O
is O
used O
by O
APT O
threat O
actors O
. O

The O
driver O
does O
not O
make O
any O
efforts O
to O
hide O
its O
own O
key O
, O
nor O
does O
it O
specifically O
check O
for O
'' O
RPC O
'' O
before O
'' O
Security O
'' O
, O
which O
can O
lead O
to O
random O
data O
being O
obfuscated O
. O

WHOIS O
records O
for O
chongryon.com O
indicate O
that O
it O
was O
registered O
by O
'' O
guanin O
o O
'' O
using O
the O
email O
address O
park2 O
@ O
mac.com O
. O

Any O
unused O
applications O
or O
functions O
should O
be O
removed O
or O
disabled O
, O
if O
possible O
, O
to O
limit O
the O
attack O
surface O
of O
the O
host O
. O

Iran O
and O
North O
Korea O
reportedly O
collaborate O
closely O
in O
ballistic O
missile O
development O
efforts O
. O

This O
spike O
in O
2012 O
is O
mainly O
due O
to O
a O
large O
attack O
campaign O
against O
a O
global O
oil O
company O
which O
took O
place O
in O
September O
2012 O
. O

SMB O
Worm O
Tool O
: O
This B-Entity
worm I-Entity
uses B-Action
a B-Entity
brute I-Entity
force I-Entity
authentication I-Entity
attack I-Entity
to O
propagate B-Action
via B-Modifier
Windows B-Entity
SMB I-Entity
shares I-Entity
. O

At O
this O
point O
, O
it O
shows O
that O
a O
probable O
VPNSOC O
employee O
with O
ties O
or O
interests O
in O
hacking O
has O
an O
undefined O
but O
potentially O
close O
relationship O
with O
Hamza O
Qamar O
, O
the O
Penetration O
Testing O
employee O
from O
Tranchulas O
. O

Periodically O
execute O
an O
'' O
offline O
'' O
backup O
of O
critical O
files O
to O
removable O
media O
. O

Emdivi O
allows O
the B-Entity
remote I-Entity
attacker I-Entity
executing B-Action
the B-Entity
commands I-Entity
to O
send B-Action
the B-Entity
results I-Entity
back B-Modifier
to I-Modifier
the B-Entity
command-and-control I-Entity
( I-Entity
C I-Entity
& I-Entity
C I-Entity
) I-Entity
server I-Entity
through B-Modifier
HTTP B-Entity
. O

Abunasar O
Khan O
has O
been O
observed O
using O
the O
aliases O
'' O
agnosticon O
'' O
and O
'' O
agnostic O
'' O
. O

) O
A B-Entity
sample I-Entity
of I-Entity
FSBSpy I-Entity
apparently O
installed O
from O
an O
exploit O
on O
a O
Turkish O
server O
talked B-Action
to B-Modifier
one B-Entity
of I-Entity
the I-Entity
servers I-Entity
in I-Entity
this I-Entity
group I-Entity
. O

s16 O
is O
the O
type O
marker O
represents O
'' O
16 O
bit O
string O
, O
'' O
and O
packageName O
is O
the O
host O
app O
's O
package O
name O
, O
where O
we O
can O
obtain O
from O
the O
information O
posted O
from O
the O
ad O
libraries O
. O

The O
Poker O
site O
had O
advertisements O
on O
the O
page O
, O
one O
of O
which O
launched O
a O
similar O
attack O
as O
seen O
in O
before O
on O
other O
websites O
visited O
by O
employees O
at O
this O
firm O
. O

We O
view O
such O
character- O
izations O
as O
the O
fundamental O
first O
step O
necessary O
for O
the O
rigorous O
, O
scientific O
pursuit O
of O
a O
new O
problem O
space O
. O

PVZ-Out B-Entity
is B-Action
the B-Entity
other I-Entity
half I-Entity
of I-Entity
the I-Entity
command I-Entity
and I-Entity
control I-Entity
channel I-Entity
, O
primarily O
uploading B-Action
results B-Entity
of I-Entity
commands I-Entity
and I-Entity
keystroke I-Entity
logging I-Entity
data I-Entity
to B-Modifier
a B-Entity
remote I-Entity
server I-Entity
. O

The B-Entity
attack I-Entity
uses B-Action
only B-Entity
known I-Entity
ASLR I-Entity
bypasses I-Entity
. O

When O
a O
user O
downloads O
the O
torrent O
and O
decrypts O
the O
zip O
files O
, O
the B-Entity
trojan I-Entity
surrepti- O
tiously O
is B-Action
installed I-Action
and I-Action
run I-Action
on B-Modifier
the B-Entity
victim I-Entity
system I-Entity
. O

This B-Entity
actor I-Entity
also O
has O
early O
access O
to O
a O
number O
of O
zero-day O
exploits O
, O
including O
Flash O
and O
Java O
, O
and O
deploys B-Action
a B-Entity
variety I-Entity
of I-Entity
malware I-Entity
families I-Entity
on B-Modifier
compromised B-Entity
systems I-Entity
. O

] O
com O
. O

In O
this O
section O
, O
we O
explain O
in O
more O
detail O
the O
risks O
of O
remote O
attacks O
on O
the O
Android O
devices O
. O

Collected O
data O
probably O
is O
presented O
in O
order O
of O
importance O
: O
Here O
is O
an O
example O
of O
one O
of O
these O
web O
pages O
: O
Clearly O
, O
some O
automated O
analysis O
activity O
involving O
researchers O
' O
sandbox O
tools O
are O
filling O
up O
these O
logs O
. O

However O
, O
it O
seemingly O
lags O
behind O
even O
most O
third O
world O
nations O
. O

Known O
tactics O
, O
techniques O
and O
procedures O
Targets O
The O
Kimsuky O
malware O
, O
which O
targeted O
South O
Korean O
think O
tanks O
, O
is O
loosely O
attributed O
to O
an O
actor O
referred O
to O
as O
Kimsukyang O
. O

A O
build O
time O
analysis O
of O
all O
known O
samples O
is O
shown O
in O
Figure O
1 O
below O
, O
relative O
to O
China O
time O
. O

By O
leveraging O
real O
time O
buying O
, O
First-Impression O
Buy-Side O
gives O
media O
buyers O
the O
full O
control O
to O
maximize O
the O
value O
of O
an O
impression O
. O

Exported O
Regin O
methods O
are O
referenced O
by O
a O
tuple O
consisting O
of O
a O
major O
and O
minor O
number O
. O

to O
pass O
commands O
, O
configuration O
parameters O
, O
binary O
images O
of O
additional O
Snake O
components O
. O

For O
analysis O
on O
the O
social O
engineering O
themes O
used O
, O
attack O
details O
and O
attachment O
types O
used O
, O
see O
Appendix O
A O
. O

The O
following O
network O
signatures O
are O
designed O
for O
the O
popular O
Open O
Source O
IDS O
called O
Snort O
. O

Here O
's O
how O
the O
big O
picture O
looks O
like O
: O
The B-Entity
first I-Entity
level I-Entity
of I-Entity
command I-Entity
and I-Entity
control I-Entity
proxies I-Entity
generally O
talk B-Action
to B-Modifier
a B-Entity
second I-Entity
level I-Entity
of I-Entity
proxies I-Entity
, O
which O
in O
turn O
, O
talk B-Action
to B-Modifier
the B-Entity
'' I-Entity
mothership I-Entity
'' I-Entity
server I-Entity
. O

The O
samples O
with O
Russian O
language O
settings O
were O
compiled O
between O
late O
2007 O
and O
late O
2013 O
, O
as O
depicted O
in O
Figure O
9 O
. O

, O
Ad92 O
to O
refer O
to O
them O
, O
where O
the O
subscripts O
represent O
the O
rankings O
of O
how O
many O
apps O
include O
the O
ad O
libraries O
. O

Rand O
function O
is O
statically O
linked O
to O
insure O
same O
results O
on O
different O
computers O
. O

The O
timeline O
below O
is O
of O
BITTERBUG O
activity O
from O
May O
2013 O
through O
March O
2014 O
. O

In O
the O
case O
of O
Stage O
3 O
, O
the O
following O
primitives O
are O
offered O
: O
These O
primitives O
are O
provided O
through O
a O
custom O
export O
methodology O
. O

Note O
: O
A O
walkthrough O
of O
our O
research O
is O
available O
in O
Appendices O
C O
, O
D O
and O
E. O
Metadata O
Analysis O
: O
As O
mentioned O
earlier O
, O
during O
the O
email O
exchanged O
with O
Zubair O
Khan O
, O
he O
sent O
TCIRT O
a O
Microsoft O
Word O
document O
( O
.docx O

The B-Entity
exploit I-Entity
downloaded B-Action
a B-Entity
second I-Entity
stage I-Entity
, O
which O
in O
turn O
downloaded B-Action
a B-Entity
sam- I-Entity
ple I-Entity
of I-Entity
SpyNet I-Entity
from B-Modifier
maile-s.com B-Entity
. O

For O
example O
, O
on O
January O
1 O
, O
2013 O
a O
global O
energy O
research O
company O
was O
targeted O
. O

As O
one O
organization O
begins O
to O
pull O
at O
a O
thread O
of O
evidence O
and O
share O
their O
findings O
with O
another O
, O
a O
larger O
understanding O
and O
shared O
perspective O
is O
revealed O
. O

This O
step O
is O
very O
hard O
to O
detect O
, O
since O
they O
only O
use O
valid O
credentials O
and O
legitimate O
administration O
tools O
such O
as O
PsExec O
. O

The O
sender O
email O
address O
was O
dyanachear O
( O
at O
) O
beyondsys.com O
and O
emails O
were O
destined O
for O
testmail00001 O
( O
at O
) O
yahoo.com O
. O

Energy O
and O
utility O
companies O
need O
to O
be O
aware O
of O
these O
risks O
and O
plan O
accordingly O
to O
protect O
their O
valuable O
information O
as O
well O
as O
their O
ICS O
or O
SCADA O
networks O
. O

In O
the O
September O
2010 O
issue O
of O
Foreign O
Affairs O
magazine O
, O
former O
US O
Deputy O
Secretary O
of O
Defense O
William O
J. O
Lynn O
discussed O
a O
cyber-attack O
which O
happened O
two O
years O
previously O
on O
the O
DoD's O
classified O
computer O
networks O
. O

Kaspersky O
found O
that O
the O
Kimsuky O
operation O
used O
10 O
IP O
addresses O
in O
two O
Chinese O
provinces O
that O
border O
North O
Korea O
: O
Jilin O
and O
Liaoning O
. O

The B-Entity
text I-Entity
of I-Entity
the I-Entity
document I-Entity
purports B-Action
to B-Modifier
provide B-Entity
domain I-Entity
and I-Entity
user I-Entity
group I-Entity
setup I-Entity
information I-Entity
for I-Entity
internal I-Entity
Windows I-Entity
XP I-Entity
and I-Entity
Windows I-Entity
7 I-Entity
systems I-Entity
. O

A O
copy O
of O
an O
MS08-067 O
exploit O
developed O
in O
Python O
was O
recovered O
in O
which O
Nesha O
shamelessly O
replaced O
the O
original O
author O
's O
name O
with O
his O
own O
. O

The O
sample O
was O
packed O
using O
ASProtect O
. O

Similarly O
, O
several O
domains O
registered O
to O
mike.johnsonmj O
@ O
yahoo.com O
have O
had O
their O
registrant O
email O
updated O
during O
March O
2014 O
( O
see O
Table O
2 O
) O
. O

The B-Entity
main I-Entity
backdoor I-Entity
is O
about O
60KB O
in O
size O
and O
implements B-Action
a B-Entity
C I-Entity
& I-Entity
C I-Entity
protocol I-Entity
on B-Modifier
top I-Modifier
of I-Modifier
normal B-Entity
HTTP I-Entity
requests I-Entity
. O

North O
Korea O
has O
reportedly O
used O
computer O
games O
for O
both O
illegal O
capital O
gain O
and O
orchestrating O
cyber O
attacks O
. O

TCP/IP O
) O
. O

Although O
APT3 O
is O
well O
known O
for O
employing O
zero-day O
exploits O
in O
their O
attacks O
, O
recent O
activity O
has O
demonstrated O
that O
they B-Entity
will O
also O
attack B-Action
targets B-Entity
with B-Modifier
known B-Entity
exploits I-Entity
or I-Entity
social I-Entity
engineering I-Entity
. O

Otherwise O
, O
malicious O
third-party O
content O
can O
be O
loaded O
into O
a O
target O
organization O
's O
website O
without O
their O
knowledge O
, O
delivering O
untold O
risks O
to O
unwitting O
visitors O
. O

Khan O
would O
go O
on O
to O
establish O
Tranchulas O
in O
February O
2006 O
after O
an O
independent O
audit O
of O
Pakistani O
Governments O
National O
Database O
and O
Registration O
Authority O
( O
NADRA O
) O
. O

Then O
it B-Entity
writes B-Action
the B-Entity
file I-Entity
to B-Modifier
disk B-Entity
with B-Modifier
CreateFileA B-Entity
and I-Entity
WriteFile I-Entity
functions I-Entity
. O

Another O
personal O
blog O
for O
cpyy O
( O
http O
: O
//www.tianya.cn/1569234/bbs O
) O
appears O
to O
have O
last O
been O
updated O
in O
2007 O
. O

The O
Cleaver O
team O
targets O
some O
of O
the O
most O
sensitive O
global O
critical O
infrastructure O
companies O
in O
the O
world O
, O
including O
military O
, O
oil O
and O
gas O
, O
airlines O
, O
airports O
, O
energy O
producers O
, O
utilities O
, O
transportation O
, O
healthcare O
, O
telecommunications O
, O
technology O
, O
manufacturing O
, O
education O
, O
aerospace O
, O
Defense O
Industrial O
Base O
( O
DIB O
) O
, O
chemical O
companies O
and O
governments O
. O

Figure O
25 O
shows O
the O
winning O
malvertising O
bid O
via O
RTB O
ad O
delivery O
from O
first-impression.com O
. O

( O
email O
addresses O
are O
twitter O
IDs- O
so O
you O
could O
be O
targeted O
for O
ad O
delivery O
based O
on O
your O
account O
name O
or O
known O
phone O
number O
) O
Twitter O
also O
rolled O
out O
the O
ability O
to O
target O
lookalike O
audiences O
, O
a O
function O
that O
seems O
pretty O
similar O
to O
Facebook O
's O
tool O
of O
the O
same O
name O
. O

It O
typically O
follows O
an O
increasing O
politicization O
within O
the O
hacking O
community O
, O
particularly O
around O
geopolitical O
events O
. O

] O
com O
between O
Oct. O
25 O
, O
2014 O
and O
Oct. O
27 O
, O
2014 O
. O

In O
Gen O
1.2 O
, O
the O
Driver O
has O
a O
hardcoded O
trigger O
string O
( O
a O
specific O
HTTP O
request O
string O
) O
and O
the O
DLL O
instructs O
the O
Driver O
to O
inspect O
a O
specific O
HTTP O
header O
field O
for O
a O
specific O
hexadecimal O
value O
. O

However O
, O
when O
Mandiant O
released O
their O
APT1 O
report O
in O
2013 O
, O
there O
was O
a O
noticeable O
reduction O
in O
activity O
from O
the O
group O
– O
and O
much O
of O
the O
tools O
and O
infrastructure O
has O
not O
been O
seen O
since O
. O

In O
many O
cases O
, O
we O
keep O
our O
descriptions O
somewhat O
imprecise O
to O
avoid O
potential O
leakage O
of O
target O
identi- O
ties O
. O

It O
is O
certainly O
possible O
that O
the O
same O
people O
have O
organized O
both O
Inception O
and O
Red O
October O
, O
but O
there O
are O
no O
clear O
indications O
to O
this O
effect O
. O

On O
the O
server O
side O
, O
we O
can O
see O
this O
information O
being O
received O
: O
zhCat B-Entity
has B-Action
a B-Entity
variety I-Entity
of I-Entity
other I-Entity
features I-Entity
such I-Entity
as I-Entity
port I-Entity
mirroring I-Entity
as I-Entity
well I-Entity
as I-Entity
traffic I-Entity
redirecting I-Entity
. O

When O
Base64 O
decoded O
, O
the O
POST O
content O
looks O
like O
this O
: O
The O
key O
used O
to O
encrypt O
the O
message O
is O
six O
bytes O
long O
and O
is O
appended O
to O
the O
end O
of O
the O
message O
. O

• O
There O
is O
an O
intense O
focus O
on O
CIKR O
companies O
in O
South O
Korea O
, O
which O
could O
give O
Iran O
additional O
clout O
in O
their O
burgeoning O
partnership O
with O
North O
Korea O
. O

The O
regime O
's O
strategic O
assets O
and O
tactical O
capabilities O
in O
the O
cyber O
arena O
seem O
to O
have O
evolved O
only O
slightly O
since O
2009 O
. O

Targeted O
economic O
espionage O
campaigns O
compromise O
technological O
advantage O
, O
diminish O
global O
competition O
, O
and O
ultimately O
have O
no O
geographic O
borders O
. O

During O
this O
phase O
the O
attacker O
tries O
to O
learn O
as O
much O
as O
possible O
about O
the O
targeted O
organization O
. O

Regin B-Entity
logs B-Action
data B-Entity
to B-Modifier
the B-Entity
ApplicationLog.dat I-Entity
file I-Entity
. O

This B-Entity
increase I-Entity
in I-Entity
privileges I-Entity
allows B-Action
for O
the B-Entity
attacker I-Entity
to O
gain B-Action
access B-Entity
to I-Entity
privleged I-Entity
areas I-Entity
of I-Entity
the I-Entity
operating I-Entity
system I-Entity
as O
well O
as O
to O
infect B-Action
other B-Entity
computers I-Entity
on I-Entity
the I-Entity
target I-Entity
network I-Entity
. O

The O
human O
element O
of O
the O
regime O
's O
cyber O
war O
program O
, O
at O
least O
, O
has O
potential O
. O

In O
2012 O
, O
an O
attack O
on O
South O
Korean O
Newspaper O
JoongAng O
Ilbo O
was O
attributed O
to O
North O
Korean O
actors O
. O

We O
summarize O
our O
key O
observations O
about O
APT28 O
in O
Figure O
11 O
below O
. O

This O
is O
becoming O
more O
and O
more O
common O
on O
the O
APT O
scene O
, O
where O
targeted B-Entity
attacks I-Entity
are O
used O
to O
compromise B-Action
high B-Entity
profile I-Entity
victims I-Entity
and O
botnet B-Entity
style I-Entity
operations I-Entity
are B-Action
used I-Action
for B-Modifier
massive B-Entity
surveillance I-Entity
or O
performing O
other O
tasks O
such O
as O
launching B-Action
DDoS B-Entity
attacks I-Entity
on B-Modifier
hostile B-Entity
parties I-Entity
or O
simply O
upgrading B-Action
victims B-Entity
to B-Modifier
more B-Entity
sophisticated I-Entity
espionage I-Entity
tools I-Entity
. O

The O
North O
Korea O
Today O
YouTube O
channel O
also O
has O
corresponding O
profiles O
on O
Twitter O
and O
Facebook O
. O

North O
Korea O
cut O
communication O
with O
Seoul O
and O
announced O
it O
had O
scrapped O
the O
1953 O
armistice O
between O
the O
two O
Koreas O
. O

Of O
course O
not O
all O
of O
the O
industrial O
control O
systems O
connected O
to O
the O
Internet O
are O
critical O
systems O
or O
even O
real O
ones O
. O

BITTERBUG B-Entity
is B-Action
a B-Entity
backdoor I-Entity
executable I-Entity
capable O
of O
uploading B-Action
and O
downloading B-Action
files B-Entity
, O
listing B-Action
running B-Entity
processes I-Entity
, O
generating B-Action
file B-Entity
listings I-Entity
, O
and O
automatically O
transferring B-Action
selected B-Entity
files I-Entity
to B-Modifier
its B-Entity
command I-Entity
and I-Entity
control I-Entity
( I-Entity
C2 I-Entity
) I-Entity
server I-Entity
. O

'' O
He O
also O
stated O
'' O
North O
Korea O
will O
continue O
to O
make O
Chongryon O
serve O
as O
Pyongyang O
's O
pawn O
in O
covert O
operations O
against O
South O
Korea O
. O

These O
characteristics O
are O
not O
all O
present O
in O
every O
sample O
, O
but O
we O
have O
typically O
found O
one O
or O
more O
in O
almost O
every O
binary O
we O
have O
examined O
that O
is O
Syrian O
regime-linked O
. O

They O
replace O
the O
existing O
Notepad.exe O
on O
the O
infected O
machine O
, O
and O
when O
run O
they B-Entity
call B-Action
out I-Action
to B-Modifier
a B-Entity
remote I-Entity
server I-Entity
and O
execute B-Action
any B-Entity
shell I-Entity
code I-Entity
returned I-Entity
by I-Entity
the I-Entity
remote I-Entity
server I-Entity
. O

The O
action O
on O
the O
account O
was O
abnormal O
as O
well O
; O
an O
apparent O
file O
upload O
: O
When O
WebDAV O
shares O
are O
mapped O
up O
as O
drives O
by O
the O
operating O
system O
, O
any O
action O
taken O
by O
the O
attacker O
follows O
the O
same O
pattern O
as O
on O
the O
attacker O
's O
local O
drive O
. O

The O
Evacuee O
Trust O
Complex O
is O
also O
known O
as O
Software O
Technology O
Park O
2 O
or O
STP2 O
and O
hosts O
a O
variety O
of O
other O
commercial O
and O
government O
offices O
. O

It O
is O
important O
to O
note O
that O
the O
'' O
Cath O
'' O
files O
are O
support O
components O
and O
not O
BITTERBUG O
variants O
, O
so O
it O
is O
probable O
that O
these O
were O
developed O
by O
another O
party O
but O
are O
a O
required O
component O
of O
the O
family O
. O

The O
remote O
shell O
function O
uses O
the O
standard O
pipe O
redirection O
method O
for O
interfacing O
a O
network O
application O
( O
in O
this O
case O
, O
the O
DLL O
) O
to O
a O
hidden O
command O
shell O
. O

Upon O
activation O
, O
the B-Entity
Driver I-Entity
will O
expose O
its O
interface O
by O
calling B-Action
IoCreateDevice B-Entity
with B-Modifier
the B-Entity
name I-Entity
\Device\agony I-Entity
( I-Entity
for I-Entity
Gen I-Entity
2.0 I-Entity
Beta I-Entity
samples I-Entity
) I-Entity
, I-Entity
\Device\HTTPS I-Entity
( I-Entity
for I-Entity
Gen I-Entity
2.1 I-Entity
samples I-Entity
) I-Entity
, I-Entity
\Device\advcachemgr I-Entity
( I-Entity
for I-Entity
Gen I-Entity
2.2 I-Entity
samples I-Entity
) I-Entity
or I-Entity
\Device\diskdump I-Entity
( I-Entity
for I-Entity
Gen I-Entity
2.3 I-Entity
samples I-Entity
) I-Entity
. O

The O
.DOC O

Our O
scan- O
ning O
suggests O
use O
of O
'' O
lawful O
intercept O
'' O
trojans O
by O
11 O
ad- O
ditional O
countries O
considered O
governed O
by O
'' O
authoritarian O
regimes O
. O

Figure O
1 O
displays O
one O
of O
the O
iframes O
. O

This O
registration O
information O
was O
current O
as O
of O
2001 O
. O

It O
is O
responsible O
for O
: O
APT28 O
made O
at O
least O
two O
specific O
attempts O
to O
target O
the O
MIA O
. O

The B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
information I-Entity
is B-Action
stored I-Action
in B-Modifier
the B-Entity
registry I-Entity
, O
not O
in O
an O
XML O
, O
and O
encoded O
: O
For O
example O
, O
in O
the O
analyzed O
sample O
the O
CC O
is O
: O
weather-online.hopto.org O
. O

These O
rumored O
activities O
, O
combined O
with O
a O
dearth O
of O
hard O
evidence O
, O
have O
made O
Russia O
into O
something O
of O
a O
phantom O
in O
cyberspace O
. O

The B-Entity
32 I-Entity
byte I-Entity
AES I-Entity
key I-Entity
and I-Entity
16 I-Entity
byte I-Entity
IV I-Entity
are B-Action
generated I-Action
by B-Modifier
repeatedly B-Entity
reading I-Entity
the I-Entity
low-order-4-bytes I-Entity
of I-Entity
the I-Entity
Windows I-Entity
clock I-Entity
. O

To O
do O
this O
, O
the O
attacker O
can O
use O
the O
remote O
calls O
exposed O
by O
WifiManager O
to O
obtain O
the O
WifiConfiguration O
objects O
, O
then O
create O
new O
proxySettings O
to O
replace O
to O
a O
corresponding O
field O
. O

One B-Entity
from I-Entity
December I-Entity
contained O
several O
BITTERBUG O
variants O
and O
used B-Action
a B-Entity
decoy I-Entity
PDF I-Entity
document I-Entity
( I-Entity
Figure I-Entity
12 I-Entity
) I-Entity
related I-Entity
to I-Entity
the I-Entity
December I-Entity
arrest I-Entity
of I-Entity
Devyani I-Entity
Khobragade I-Entity
, I-Entity
an I-Entity
Indian I-Entity
diplomat I-Entity
in I-Entity
the I-Entity
United I-Entity
States I-Entity
. O

Unfortunately O
, O
several B-Entity
well-known I-Entity
attacks I-Entity
can O
be O
used O
to O
achieve B-Action
large-scale B-Entity
monitoring I-Entity
, O
including O
DNS O
hijacking O
, O
BGP O
hijacking O
, O
and O
ARP O
hijacking O
in O
IDC O
. O

Based O
on O
these O
samples O
, O
we O
devised O
YARA O
signa- O
tures O
that O
yielded O
23 O
additional O
samples O
of O
structurally O
similar O
malware O
. O

Around O
this O
time O
a O
significant O
shift O
in O
philosophy O
began O
to O
take O
place O
. O

Red O
Sky O
also O
targeted O
M O
in O
Figure O
2 O
. O

Brian O
is O
a O
Sr. O
Security O
Researcher O
for O
Cylance O
who O
joined O
shortly O
after O
the O
company O
was O
established O
. O

Implemented O
values O
for O
cmdID O
are O
as O
follows O
: O
cmdType O
can O
be O
one O
of O
the O
following O
( O
Interesting O
commands O
explained O
in O
detail O
) O
: O
string0 O
can O
have O
one O
of O
the O
following O
values O
dependant O
upon O
command O
id O
and O
type O
. O

As O
of O
April O
2012 O
, O
North O
Korea O
reportedly O
used O
the O
Intelsat O
connection O
, O
which O
appeared O
in O
border O
gateway O
protocol O
( O
BGP O
) O
announcements O
. O

While O
FireEye O
has O
not O
attributed O
this O
activity O
to O
a O
specific O
threat O
group O
, O
we O
frequently O
observe O
China-based O
threat O
actors O
target O
non-profits O
and O
NGOs O
, O
and O
we O
suspect O
that O
they O
seek O
to O
monitor O
activity O
within O
their O
borders O
that O
may O
lead O
to O
domestic O
unrest O
or O
embarrass O
the O
Chinese O
government O
. O

As O
the O
name O
implies O
, O
the O
exit O
command O
causes O
the O
DLL O
to O
discontinue O
the O
current O
connection O
. O

The B-Entity
sabotage I-Entity
payload I-Entity
disrupted B-Action
and I-Action
partially I-Action
destroyed I-Action
the B-Entity
cascaded I-Entity
high I-Entity
frequency I-Entity
gas I-Entity
centrifuges I-Entity
. O

According O
to O
statistics O
released O
by O
CNN O
in O
2014 O
, O
North O
Korea's O
ground O
arsenal O
includes O
4100 O
tanks O
, O
2100 O
armored O
vehicles O
, O
and O
8500 O
pieces O
of O
field O
artillery O
. O

The B-Entity
attacker I-Entity
may O
then O
craft O
an O
exploit O
against O
those O
hosts O
, O
possibly O
by O
using O
the O
Metasploit O
framework O
, O
and O
then O
deliver B-Action
the B-Entity
generated I-Entity
shellcode I-Entity
back B-Modifier
to I-Modifier
the B-Entity
reconnaissance I-Entity
tool I-Entity
to B-Modifier
be B-Entity
applied I-Entity
against I-Entity
the I-Entity
identified I-Entity
hosts I-Entity
by I-Entity
running I-Entity
the I-Entity
tool I-Entity
with I-Entity
the I-Entity
'expos I-Entity
' I-Entity
switch I-Entity
. O

For O
more O
information O
about O
this O
see O
: O
The O
'' O
Red O
October O
'' O
Campaign O
- O
An O
Advanced O
Cyber O
Espionage O
Network O
Targeting O
Diplomatic O
and O
Government O
Agencies O
However O
, O
there O
are O
also O
clear O
differences O
. O

For O
example O
, O
in O
2013 O
, O
FireEye O
observed O
China-based O
threat O
actors O
steal O
grant O
applications O
and O
activity O
reports O
specifically O
related O
to O
an O
international O
NGO O
's O
China-based O
activities O
. O

FireEye O
currently O
has O
detection O
measures O
in O
place O
that O
should O
allow O
users O
of O
FireEye O
products O
to O
detect O
this O
SWC O
activity O
. O

The B-Entity
email I-Entity
data I-Entity
exfiltration I-Entity
method I-Entity
also O
underwent B-Action
modification B-Entity
to B-Modifier
be B-Entity
activated I-Entity
at I-Entity
a I-Entity
scheduled I-Entity
interval I-Entity
. O

Some O
of O
the O
attacks O
have O
been O
purely O
opportunistic O
, O
seeking O
any O
valuable O
information O
available O
. O

It O
is O
also O
necessary O
to O
provide O
a O
brief O
explanation O
of O
how O
North O
Korea O
and O
South O
Korea O
view O
one O
another O
, O
in O
order O
to O
understand O
the O
basis O
for O
conflict O
between O
the O
two O
. O

First O
, O
the B-Entity
virus I-Entity
retrieves B-Action
all B-Entity
available I-Entity
disks I-Entity
and O
starting O
from O
disk O
number O
4 O
( O
D O
: O
\ O
) O
to O
disk O
number O
20 O
( O
Z O
: O
\ O
) O
, O
finds B-Action
executable B-Entity
files I-Entity
and O
infects B-Action
them B-Entity
. O

The O
attack O
was O
not O
too O
sophisticated O
as O
it O
was O
easily O
spotted O
. O

A O
long-running O
HTTP O
POST O
request O
to O
the O
path O
'' O
/forum/login.cgi O
'' O
with O
a O
statically O
defined O
HTTP O
request O
string O
including O
HTTP O
headers O
( O
optionally O
over O
a O
HTTP O
Proxy O
using O
CONNECT O
) O
. O

For O
example O
, O
U.S. O
export O
laws O
forbid O
the O
sale O
of O
dual-use O
technologies O
, O
or O
those O
that O
can O
be O
used O
or O
repurposed O
for O
both O
civilian O
and O
military O
use O
, O
to O
North O
Korea O
. O

It O
's O
interesting O
that O
the B-Entity
Flash I-Entity
objects I-Entity
were B-Action
embedded I-Action
in B-Modifier
Korean B-Entity
documents I-Entity
titled I-Entity
'' I-Entity
List I-Entity
of I-Entity
the I-Entity
latest I-Entity
Japanese I-Entity
AV I-Entity
wind I-Entity
and I-Entity
how I-Entity
to I-Entity
use I-Entity
torrents.docx I-Entity
'' I-Entity
( I-Entity
loose I-Entity
English I-Entity
translation I-Entity
) I-Entity
. O

At O
the O
time O
of O
execution O
, O
the O
system O
only O
has O
its O
own O
credentials O
available O
and O
no O
cached O
network O
credentials O
. O

Tactical O
capabilities O
refer O
to O
the O
methods O
and O
maneuvers O
actually O
implemented O
in O
pursuit O
of O
the O
strategic O
goal O
. O

Gen B-Entity
2 I-Entity
samples I-Entity
rely B-Action
on B-Modifier
a B-Entity
configuration I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
know B-Entity
where I-Entity
the I-Entity
C2 I-Entity
server I-Entity
exists I-Entity
along O
with O
other O
operational O
aspects O
such O
as O
the O
name O
of O
its O
service O
and O
operational O
times O
. O

'' O
was O
not O
needed O
. O

Visiting O
reporter O
Jean O
H. O
Lee O
purportedly O
used O
this O
3G O
network O
to O
post O
to O
both O
Twitter O
and O
Instagram O
. O

According O
to O
Kim O
Heung-kwang O
, O
a O
North O
Korean O
defector O
and O
former O
computer O
science O
professor O
, O
the O
regime O
has O
the O
following O
motivations O
for O
expanding O
its O
cyber O
warfare O
capabilities O
: O
 O
Cyber O
capabilities O
are O
a O
cost-effective O
way O
to O
offset O
North O
Korea O
's O
lack O
of O
kinetic O
military O
prowess O
. O

Log O
output O
from O
the O
network O
port O
scanning O
application O
NMAP O
was O
recovered O
from O
a O
staging O
server O
. O

• O
In O
the O
first O
mode O
, O
it B-Entity
relies B-Action
on I-Action
Windows B-Entity
Internet I-Entity
( I-Entity
WinINet I-Entity
) I-Entity
APIs I-Entity
, I-Entity
such I-Entity
as I-Entity
HttpOpenRequest I-Entity
( I-Entity
) I-Entity
, I-Entity
HttpSendRequest I-Entity
( I-Entity
) I-Entity
, I-Entity
InternetReadFile I-Entity
( I-Entity
) I-Entity
, I-Entity
etc I-Entity
. O

MiniDuke B-Entity
gathers B-Action
information B-Entity
about I-Entity
the I-Entity
system I-Entity
and O
encrypts B-Action
its B-Entity
configuration I-Entity
based B-Modifier
on I-Modifier
that B-Entity
information I-Entity
, O
a O
method O
also O
used O
by O
OSX/Flashback O
( O
this O
process O
is O
called O
watermarking O
by O
Bitdefender O
) O
. O

With O
more O
specialized O
teams O
of O
attackers O
, O
we O
can O
often O
observe O
that O
the B-Entity
infected I-Entity
system I-Entity
is B-Action
first I-Action
analyzed I-Action
to B-Modifier
ensure B-Entity
that I-Entity
it I-Entity
is I-Entity
of I-Entity
interest I-Entity
to I-Entity
them I-Entity
. O

The O
code O
quality O
is O
not O
impressive O
, O
and O
contains O
a O
trivial O
stack O
buffer O
overflow O
vulnerability O
. O

The O
country O
's O
only O
autonomous O
system O
( O
AS O
) O
number O
is O
AS131279 O
, O
and O
its O
only O
peer O
is O
AS4837 O
, O
the O
AS O
for O
China O
Unicom O
. O

Clicking O
that O
link O
from O
a O
Windows O
PC O
only O
yielded O
a O
redirection O
to O
the O
BBC O
homepages O
, O
and O
using O
other O
devices O
did O
not O
give O
more O
data O
. O

Different O
groups O
may O
use O
similar O
intrusion O
methodologies O
and O
common O
tools O
, O
particularly O
those O
that O
are O
widely O
available O
on O
the O
Internet O
, O
such O
as O
pwdump O
, O
HTran O
, O
or O
Gh0st O
RAT O
. O

Note O
that O
such O
an O
account O
does O
not O
normally O
exist O
in O
an O
Active O
Directory O
environment O
. O

In O
order O
to O
hide B-Action
its B-Entity
components I-Entity
, O
the B-Entity
driver I-Entity
hooks B-Action
the B-Entity
following I-Entity
APIs I-Entity
: O
For O
example O
, O
the B-Entity
hook I-Entity
handlers I-Entity
of I-Entity
the I-Entity
registry-related I-Entity
APIs I-Entity
will O
block B-Action
access B-Entity
to I-Entity
the I-Entity
registry I-Entity
entries I-Entity
that I-Entity
contain I-Entity
the I-Entity
name I-Entity
of I-Entity
the I-Entity
driver I-Entity
. O

It O
is O
likely O
that O
this O
organization O
is O
staffed O
in O
part O
by O
current O
or O
former O
students O
of O
SJTU O
, O
and O
shares O
some O
resources O
and O
direction O
with O
PLA O
Unit O
61398 O
( O
COMMENT O
PANDA O
) O
. O

Recordings B-Entity
are B-Action
stored I-Action
as B-Modifier
*.mp4 B-Entity
files I-Entity
, O
and O
uploaded B-Action
to B-Modifier
the B-Entity
attackers I-Entity
periodically B-Entity
. O

Many B-Entity
of I-Entity
their I-Entity
backdoors I-Entity
were B-Action
web B-Entity
applications I-Entity
, O
added O
to O
web O
servers O
, O
so O
commands B-Entity
can O
be B-Action
executed I-Action
from B-Modifier
a B-Entity
browser I-Entity
or I-Entity
client I-Entity
able I-Entity
to I-Entity
communicate I-Entity
with I-Entity
them I-Entity
. O

The O
files O
are O
injected O
into O
services.exe O
. O

Meanwhile O
, O
internally O
the O
authors O
behind O
this O
malware O
were O
using O
their O
own O
naming O
systems O
- O
with O
specific O
titles O
for O
their O
file O
components O
and O
projects O
such O
as O
'' O
snake O
'' O
, O
'' O
uroburos O
'' O
, O
'' O
sengoku O
'' O
, O
and O
'' O
snark O
'' O
used O
to O
denote O
variants O
of O
their O
framework O
. O

We O
have O
some O
suspicion O
of O
a O
customer O
relationship O
manager O
position O
that O
may O
act O
as O
an O
interface O
between O
a O
customer O
and O
Chen O
. O

At O
present O
, O
North O
Korea O
relies O
on O
China O
to O
provide O
much O
of O
its O
network O
hardware O
, O
including O
servers O
and O
routers O
. O

A O
container O
starts O
with O
the O
header O
in O
Table O
3 O
( O
little-endian O
ordering O
) O
. O

The B-Entity
thread I-Entity
writes B-Action
user B-Entity
activity I-Entity
log I-Entity
messages I-Entity
to B-Modifier
the B-Entity
'' I-Entity
checkmesv5555 I-Entity
'' I-Entity
mailslot I-Entity
in B-Modifier
plain B-Entity
text I-Entity
. O

These B-Entity
tools I-Entity
are O
often O
support O
tools O
, O
either O
monitoring B-Action
the B-Entity
activity I-Entity
of I-Entity
other I-Entity
tools I-Entity
or O
supplementing B-Action
the B-Entity
function I-Entity
of I-Entity
other I-Entity
tools I-Entity
gathering I-Entity
information I-Entity
during I-Entity
the I-Entity
infiltration I-Entity
process I-Entity
. O

As O
most O
organizations O
working O
on O
issues O
surrounding O
Syria O
are O
aware O
, O
malware O
delivered O
with O
good O
social O
engineering O
is O
a O
constant O
source O
of O
danger O
. O

The O
attacks O
coincided O
with O
State O
Department O
negotiations O
with O
North O
Korea O
regarding O
the O
regime O
's O
nuclear O
missile O
tests O
. O

They B-Entity
were O
observed O
conducting B-Action
SQL B-Entity
injections I-Entity
, O
controlling B-Action
backdoors B-Entity
, O
as O
well O
as O
exfiltrating B-Action
information B-Entity
using B-Modifier
this B-Entity
address I-Entity
, O
and O
the O
address O
appears O
in O
multiple O
software O
configurations O
recovered O
from O
staging O
servers O
over O
a O
period O
of O
time O
. O

This B-Entity
driver I-Entity
is B-Action
set I-Action
up I-Action
above B-Modifier
a B-Entity
miniport I-Entity
driver I-Entity
( O
a O
driver O
that O
communicates O
with O
the O
physical O
device O
) O
and O
below B-Modifier
a B-Entity
protocol I-Entity
driver I-Entity
( O
a O
driver O
that O
implements O
a O
protocol O
, O
e.g O
. O

One O
such O
case O
is O
the O
franko7046 O
account O
, O
used O
against O
the O
previously O
mentioned O
bank O
CEO O
. O

In O
a O
blog O
post O
below O
, O
Neustar O
boasts O
about O
their O
direct O
to O
IP O
range O
and O
enterprise O
advertising O
. O

 O
On O
more O
than O
one O
occasion O
, O
the O
malware O
included O
provisions O
to O
disable O
security O
software O
made O
by O
South O
Korean O
security O
company O
AhnLab O
. O

] O
com/java.jar O
on O
August O
15 O
, O
2014 O
. O

Second O
, O
North O
Korea O
may O
lay O
claim O
to O
responsibility O
for O
an O
attack O
that O
exceeds O
its O
capabilities O
in O
order O
to O
seem O
more O
technologically O
advanced O
and O
more O
capable O
. O

The B-Entity
group I-Entity
was O
able O
to O
compromise B-Action
these B-Entity
websites I-Entity
and O
insert B-Action
malicious B-Entity
iframes I-Entity
. O

We O
have O
to O
mention O
that O
we O
only O
had O
access O
to O
three O
of O
the O
several O
attackers O
' O
servers O
. O

In O
response O
to O
these O
restrictions O
, O
Iranians O
have O
been O
increasingly O
using O
software O
that O
bypasses O
such O
filtering O
technology O
. O

The O
updates O
are O
significant O
for O
both O
of O
the O
longstanding O
malware O
families O
; O
before O
this O
year O
, O
Aumlib O
had O
not O
changed O
since O
at O
least O
May O
2011 O
, O
and O
Ixeshe O
had O
not O
evolved O
since O
at O
least O
December O
2011 O
. O

We O
track O
all O
of O
the O
indicators O
and O
significant O
linkages O
associated O
with O
identified O
threat O
groups O
in O
a O
proprietary O
database O
that O
comprises O
millions O
of O
nodes O
and O
linkages O
between O
them O
. O

No O
uploads O
were O
seen O
between O
23:00 O
and O
05:00 O
UTC O
. O

This O
behaviour O
strongly O
suggests O
that O
the O
function O
of O
this B-Entity
malware I-Entity
is O
to O
serve B-Action
as B-Modifier
a B-Entity
beacon I-Entity
. O

Threat B-Entity
actors I-Entity
create O
a O
corporate O
front O
, O
advertise O
on O
commonly O
visited O
sites O
, O
then O
later O
switch B-Action
out B-Modifier
the B-Entity
landing I-Entity
pages I-Entity
for I-Entity
their I-Entity
ads I-Entity
to B-Modifier
pages B-Entity
that I-Entity
host I-Entity
exploit I-Entity
kits I-Entity
, O
or O
simply O
create B-Action
a B-Entity
temporary I-Entity
redirection I-Entity
from I-Entity
their I-Entity
usual I-Entity
content I-Entity
to I-Entity
the I-Entity
malicious I-Entity
landing I-Entity
page I-Entity
. O

When O
two O
nearly O
identical O
dlls O
are O
encoded O
using O
the O
polymorphic O
scheme O
there O
is O
very O
little O
code O
in O
common O
. O

The O
same O
family O
of O
dropper O
has O
been O
used O
in O
previous O
targeted O
attacks O
against O
other O
sectors O
, O
indicating O
that O
a O
group O
with O
multiple O
interests O
is O
behind O
the O
attacks O
. O

While B-Modifier
the B-Entity
user I-Entity
enters I-Entity
this I-Entity
information I-Entity
, O
their B-Entity
machine I-Entity
is B-Action
infected I-Action
with B-Modifier
TinyZBot B-Entity
. O

Because O
the B-Entity
operators I-Entity
very O
actively O
build B-Action
up I-Action
new B-Entity
command I-Entity
and I-Entity
control I-Entity
serv- I-Entity
ers I-Entity
, O
it O
is O
difficult O
to O
sinkhole O
enough O
domains O
to O
get O
an O
accurate O
overall O
picture O
of O
victim O
system O
location O
based O
on O
this O
data O
. O

framework O
, O
which O
is O
typically O
an O
indication O
of O
a O
less O
sophis- O
ticated O
attacker O
, O
because O
.NET O

We O
have O
also O
observed O
cracked O
versions O
of O
these O
RATs O
on O
Arabic- O
language O
hacker O
forums O
, O
making O
them O
available O
with O
little O
ef- O
fort O
and O
no O
payment O
trail O
. O

This O
IP O
has O
hosted O
other O
domains O
used O
by O
APT3 O
in O
past O
campaigns O
: O
As O
we O
discussed O
in O
our O
previous O
blog O
detailing O
previous O
APT3 O
activity O
, O
the B-Entity
walterclean I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
served B-Action
as B-Modifier
a B-Entity
Plugx/Kaba I-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
. O

The B-Entity
malware I-Entity
used I-Entity
in I-Entity
these I-Entity
attacks I-Entity
sought B-Action
out I-Action
and O
exfiltrated B-Action
data B-Entity
, O
based O
on O
keyword O
searches O
. O

We O
do O
not O
currently O
know O
why O
this B-Entity
malware I-Entity
uses B-Action
the B-Entity
same I-Entity
patterns I-Entity
to B-Modifier
communicate B-Entity
. O

In O
2012 O
, O
North O
Korea O
and O
Iran O
signed O
a O
technology O
treaty O
to O
help O
combat O
'' O
common O
enemies O
'' O
in O
cyberspace O
. O

Our O
investigation O
has O
been O
focused O
on O
the O
data O
we O
could O
get O
from O
these O
c O
& O
c O
servers O
but O
also O
on O
the O
Pitty O
Tiger O
environment O
. O

The B-Entity
files I-Entity
for I-Entity
Stage I-Entity
4 I-Entity
, O
which O
are B-Action
loaded I-Action
by O
Stage B-Entity
3 I-Entity
, O
consist O
of O
a O
user-mode O
orchestrator O
and O
multiple O
kernel O
payload O
modules O
. O

He O
was O
is O
28 O
years O
old O
( O
born O
September O
5 O
, O
1983 O
) O
and O
lives O
in O
Xiamen O
, O
Fujian O
province O
( O
Nanjing O
Military O
Region O
) O
. O

The O
only O
information O
Intelliforms O
offers O
about O
the O
place O
where O
given O
login/password O
should O
be O
used O
is O
a O
hash O
of O
the O
webpage O
URL O
. O

Unlike O
traditional O
worm O
techniques O
, O
this O
process O
is O
rather O
manual O
, O
but O
its O
danger O
is O
in O
the O
fact O
that O
the B-Entity
attacker I-Entity
can O
flexibly O
craft O
new O
attack O
methods O
, O
adjusting B-Action
them B-Entity
to B-Modifier
the B-Entity
hosts I-Entity
present I-Entity
within I-Entity
the I-Entity
network I-Entity
, O
thus O
preying O
on O
the O
weakest O
( O
least O
updated O
, O
most O
vulnerable O
) O
victims O
along O
its O
path O
. O

Much O
of O
my O
passion O
for O
cybersecurity O
can O
be O
directly O
attributed O
to O
that O
fateful O
day O
. O

The B-Entity
malware I-Entity
uses O
several O
methods O
to O
access B-Action
shares B-Entity
on B-Modifier
the B-Entity
remote I-Entity
systems I-Entity
to O
begin O
wiping B-Action
files B-Entity
. O

For O
example O
multiple O
computers O
at O
Chevron O
were O
infected O
by O
Stuxnet O
, O
without O
any O
damage O
being O
done O
. O

'' O
The B-Entity
second I-Entity
bait I-Entity
file I-Entity
is O
a O
dummy O
program O
containing O
DarkComet O
while O
masquerading B-Action
as B-Modifier
a B-Entity
Skype I-Entity
call I-Entity
encryption I-Entity
program I-Entity
, O
playing O
to O
opposition O
para- O
noia O
about O
government O
backdoors O
in O
common O
software O
. O

No O
Stage O
5 O
payload O
modules O
have O
been O
recovered O
. O

The O
use O
of O
software O
vulnerabilities O
in O
order O
to O
execute O
malicious O
software O
on O
unsuspecting O
users O
' O
computers O
is O
an O
important O
parameter O
to O
monitor O
. O

The B-Entity
operators I-Entity
of I-Entity
the I-Entity
blog I-Entity
IranRedLine.org I-Entity
, I-Entity
which I-Entity
comments I-Entity
on I-Entity
Iran I-Entity
's I-Entity
nuclear I-Entity
weapons I-Entity
efforts I-Entity
, O
has O
mentioned B-Action
in B-Modifier
multiple B-Entity
posts I-Entity
having B-Entity
been I-Entity
the I-Entity
target I-Entity
of I-Entity
debilitating I-Entity
brute-force I-Entity
authentication I-Entity
attacks I-Entity
from I-Entity
IP I-Entity
addresses I-Entity
registered I-Entity
to I-Entity
the I-Entity
same I-Entity
Tarh I-Entity
Andishan I-Entity
team I-Entity
found I-Entity
in I-Entity
Cleaver I-Entity
. O

In O
September O
and O
October O
of O
2014 O
, O
Invincea O
saw O
a O
sharp O
spike O
of O
malvertising B-Entity
delivering B-Action
CryptoWall B-Entity
ransomware I-Entity
attacks I-Entity
via B-Modifier
Real B-Entity
Time I-Entity
Ad I-Entity
Bidding I-Entity
. O

North O
Korea O
's O
OCO O
and O
CNO O
capabilities O
became O
apparent O
as O
early O
as O
2004 O
, O
when O
North O
Korea O
reportedly O
gained O
access O
to O
33 O
of O
80 O
South O
Korean O
military O
wireless O
communication O
networks O
. O

In O
addition O
, O
if O
ISIS O
is O
indeed O
responsible O
, O
this O
case O
suggests O
how O
easy O
it O
is O
for O
belligerents O
in O
a O
conflict O
to O
begin O
fielding O
basic O
offensive O
digital O
capabilities O
, O
and O
how O
quickly O
the O
capabilities O
can O
be O
pointed O
at O
unarmed O
civil O
society O
groups O
. O

org O
. O

As O
such O
, O
we O
believe O
that O
attackers B-Entity
disguised B-Action
malware B-Entity
as B-Modifier
anti-censorship B-Entity
tools I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
target B-Entity
the I-Entity
users I-Entity
of I-Entity
such I-Entity
tools I-Entity
inside I-Entity
Iran I-Entity
as I-Entity
well I-Entity
as I-Entity
Iranian I-Entity
dissidents I-Entity
outside I-Entity
the I-Entity
country I-Entity
. O

However O
, O
this O
turned O
out O
to O
be O
a O
wrong O
assumption O
. O

The O
purpose O
of O
TinyZBot B-Entity
is O
to O
gather B-Action
information B-Entity
from B-Modifier
an B-Entity
infected I-Entity
computer I-Entity
as O
well O
as O
maintain B-Action
and O
further B-Action
access B-Entity
into I-Entity
a I-Entity
compromised I-Entity
network I-Entity
. O

Speculatively O
this O
may O
be O
because O
this O
security O
product O
detects O
this O
rootkit O
, O
or O
the O
author O
was O
attempting O
to O
prevent O
accidental O
infection O
on O
systems O
running O
this O
Anti-Virus O
product O
. O

§1 O
) O
, O
whose O
click O
appears O
to O
have O
been O
used O
against O
him O
in O
court O
. O

Strong O
authentication O
or O
PKI O
should O
be O
used O
where O
applicable O
. O

Furthermore O
, O
the B-Entity
attackers I-Entity
also O
shared B-Action
a B-Entity
C I-Entity
& I-Entity
C I-Entity
domain I-Entity
. O

They B-Entity
achieved B-Action
complete B-Entity
access I-Entity
to I-Entity
airport I-Entity
gates I-Entity
and I-Entity
their I-Entity
security I-Entity
control I-Entity
systems I-Entity
, O
potentially O
allowing B-Action
them B-Entity
to B-Modifier
spoof B-Entity
gate I-Entity
credentials I-Entity
. O

The O
FireEye O
Threat O
Prevention O
Platform O
provides O
real-time O
, O
dynamic O
threat O
protection O
without O
the O
use O
of O
signatures O
to O
protect O
an O
organization O
across O
the O
primary O
threat O
vectors O
and O
across O
the O
different O
stages O
of O
an O
attack O
life O
cycle O
. O

If O
the B-Entity
attackers I-Entity
can O
hijack B-Action
the B-Entity
communication I-Entity
channels I-Entity
and O
inject B-Action
malicious B-Entity
DEX I-Entity
files I-Entity
, O
they B-Entity
can O
then O
control B-Action
the B-Entity
behaviors I-Entity
of I-Entity
the I-Entity
victim I-Entity
apps I-Entity
. O

This B-Entity
DLL I-Entity
is B-Action
a B-Entity
moderately I-Entity
sophisticated I-Entity
backdoor I-Entity
with O
several O
well O
designed O
communication O
mechanisms O
not O
typically O
seen O
in O
these O
types O
of O
implants O
. O

A O
curious O
Remote O
Access O
Trojan O
, O
as O
research O
points O
to O
a O
Chinese O
connection O
but O
the O
commands O
it O
listens O
to O
are O
in O
Spanish O
( O
translation O
in O
English O
) O
: O
The B-Entity
malware I-Entity
can O
manage B-Action
processes B-Entity
and I-Entity
services I-Entity
on I-Entity
the I-Entity
infected I-Entity
machine I-Entity
, O
transfer B-Action
files B-Entity
to B-Modifier
and O
from B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
, O
run B-Action
shell B-Entity
commands I-Entity
, O
and O
so O
on O
. O

The O
debug O
file O
path O
for O
PVZ-Out O
is O
: O
PVZ-Out O
has O
been O
observed O
with O
the O
file O
name O
osppsvc.exe O
. O

ComRAT O
, O
in O
its O
version O
3.25 O
, O
shows O
the O
same O
behavior O
. O

For O
instance O
, O
if O
the O
string O
'' O
ERROR O
'' O
is O
in O
the O
response O
, O
the O
text O
is O
displayed O
with O
the O
color O
magenta O
. O

While O
the O
attack O
vector O
is O
the O
same O
, O
we O
believe O
this O
to O
be O
motivated O
by O
cybercrime O
rather O
than O
theft O
of O
IP O
from O
Defense O
companies O
. O

The O
attackers O
either O
need O
to O
boot O
a O
Java O
VM O
from O
the O
Javascript O
bridge O
, O
or O
to O
inject O
code O
into O
the O
host O
app O
's O
Java O
VM O
. O

The O
64-bit O
Regin O
's O
Stage O
3 O
has O
not O
been O
recovered O
. O

U.S. O
and O
South O
Korean O
military O
entities O
were O
also O
targeted O
by O
DDoS O
during O
this O
attack O
. O

These B-Entity
attack I-Entity
vectors I-Entity
include B-Action
sending B-Entity
email I-Entity
, I-Entity
private I-Entity
messages I-Entity
via I-Entity
social I-Entity
media I-Entity
, I-Entity
fake I-Entity
login I-Entity
pages I-Entity
, I-Entity
and I-Entity
the I-Entity
propagation I-Entity
of I-Entity
anti-censorship I-Entity
software I-Entity
that I-Entity
has I-Entity
been I-Entity
infected I-Entity
with I-Entity
malware I-Entity
. O

This O
gives O
the B-Entity
attackers I-Entity
a O
predictable O
method O
to O
regain B-Action
access B-Entity
to I-Entity
a I-Entity
compromised I-Entity
network I-Entity
if B-Modifier
they B-Entity
ever I-Entity
lose I-Entity
access I-Entity
. O

In O
September O
2014 O
, O
APT28 B-Entity
registered B-Action
a B-Entity
domain I-Entity
( I-Entity
smigroup- I-Entity
online.co I-Entity
[ I-Entity
. I-Entity
] I-Entity
uk I-Entity
) I-Entity
that I-Entity
appeared I-Entity
to I-Entity
mimic I-Entity
that I-Entity
for I-Entity
the I-Entity
SMi I-Entity
Group I-Entity
, O
a O
company O
that O
plans O
events O
for O
the O
'' O
Defence O
, O
Security O
, O
Energy O
, O
Utilities O
, O
Finance O
and O
Pharmaceutical O
sectors O
. O

Abunasar O
Khan O
registered O
abunasar.net O
and O
previously O
( O
May O
2007 O
) O
and O
maintained O
whitehate.org O
, O
which O
have O
both O
been O
used O
to O
demonstrate O
an O
affinity O
for O
and O
alignment O
with O
AntiSec O
and O
Anonymous O
movements O
. O

He O
was O
sentenced O
to O
one O
month O
in O
prison O
, O
partly O
on O
the O
basis O
of O
his O
confession O
. O

These O
digital O
fingerprints O
are O
unique O
to O
this O
adversary O
for O
this O
campaign O
. O

The B-Entity
payload I-Entity
dropped B-Action
by O
these O
Java B-Entity
exploits I-Entity
is O
the O
following O
: O
The B-Entity
Java I-Entity
exploit I-Entity
use B-Action
a B-Entity
special I-Entity
loader I-Entity
that O
attempts O
to O
inject B-Action
the B-Entity
final I-Entity
Epic I-Entity
backdoor I-Entity
payload I-Entity
into B-Modifier
explorer.exe B-Entity
. O

Three O
such O
accounts O
were O
found O
hardcoded O
in O
the O
package O
: O
The O
accounts O
all O
state O
that O
they O
belong O
to O
Iranian O
users O
. O

• O
CCommandNOP O
– O
List O
the O
current O
working O
directory O
. O

Therefore O
, O
we O
suppose O
the O
Pitty O
Tiger O
group O
could O
have O
more O
targets O
than O
what O
we O
could O
confirm O
. O

Next O
we O
go O
in O
some O
detail O
about O
example O
attacks O
perpetrated O
against O
the O
defense O
firms O
. O

During O
2014 O
, O
there O
were O
a O
number O
of O
reports-many O
unconfirmed-that O
ISIS O
confiscated O
smartphones O
and O
laptops O
from O
captured O
activists O
. O

The B-Entity
dropper I-Entity
component I-Entity
is O
responsible O
for O
creating B-Action
all B-Entity
the I-Entity
required I-Entity
files I-Entity
on I-Entity
the I-Entity
system I-Entity
, O
registering B-Action
a B-Entity
service I-Entity
called I-Entity
'' I-Entity
TrkSvr I-Entity
'' I-Entity
in O
order O
to O
start B-Action
itself B-Entity
with B-Modifier
Windows B-Entity
. O

Logger O
Module O
has O
been O
observed O
using O
the O
name O
ospcsvc.exe O
. O

This O
helped O
to O
cover O
their O
activities O
and O
avoid O
unwanted O
attention O
. O

The O
purpose O
of O
the B-Entity
hook I-Entity
is O
to O
scan B-Action
the B-Entity
list I-Entity
of I-Entity
active I-Entity
connections I-Entity
returned I-Entity
to I-Entity
the I-Entity
user I-Entity
, O
and O
hide B-Action
any B-Entity
such I-Entity
connection I-Entity
currently I-Entity
bound I-Entity
to I-Entity
a I-Entity
local I-Entity
TCP I-Entity
port I-Entity
in I-Entity
the I-Entity
range I-Entity
between I-Entity
40000 I-Entity
and I-Entity
45000 I-Entity
. O

Some O
clues O
might O
have O
been O
added O
by O
accident O
, O
but O
none O
of O
these O
indicators O
can O
be O
trusted O
in O
any O
way O
. O

The O
file O
is O
encrypted O
; O
to O
access O
it O
on O
your O
machine O
use O
the O
password O
'' O
infected O
. O

We O
initially O
knew O
little O
about O
who O
the O
actual O
targets O
were O
; O
apart O
from O
one O
. O

Unlike O
Syrian O
regime-linked O
malware O
, O
it O
contains O
no O
Remote O
Access O
Trojan O
( O
RAT O
) O
functionality O
, O
suggesting O
it B-Entity
is O
intended O
for O
identifying B-Action
and I-Action
locating I-Action
a B-Entity
target I-Entity
. O

Regin B-Entity
is O
capable O
of O
installing B-Action
a B-Entity
large I-Entity
number I-Entity
of I-Entity
additional I-Entity
payloads I-Entity
, O
some O
highly O
customized O
for O
the O
targeted O
computer O
. O

In O
2013 O
, O
South O
Korean O
officials O
released O
information O
stating O
they O
had O
found O
evidence O
that O
North O
Korea O
was O
using O
games O
as O
a O
medium O
for O
infecting O
machines O
and O
launching O
cyber O
attacks O
. O

Disttrack B-Entity
's O
secondary O
goal O
may O
have O
been O
to O
steal B-Action
valuable B-Entity
information I-Entity
from B-Modifier
infected B-Entity
computers I-Entity
, O
but O
the O
main O
intent O
was O
to O
render B-Action
the B-Entity
computers I-Entity
unusable I-Entity
by O
wiping B-Action
the B-Entity
operating I-Entity
system I-Entity
and I-Entity
master I-Entity
boot I-Entity
record I-Entity
, O
causing O
disruption O
and O
downtime O
at O
the O
targeted O
company O
. O

After O
decrypting O
itself O
and O
obtaining O
the O
addresses O
of O
some O
functions O
exported O
by O
kernel32.dll O
, O
it B-Entity
decrypts B-Action
and I-Action
drops I-Action
the B-Entity
payload I-Entity
in B-Modifier
the B-Entity
% I-Entity
TEMP I-Entity
% I-Entity
directory I-Entity
in I-Entity
a I-Entity
file I-Entity
named I-Entity
'' I-Entity
a.l I-Entity
'' I-Entity
which O
is B-Action
subsequently I-Action
loaded I-Action
by B-Modifier
calling B-Entity
kernel32 I-Entity
! I-Entity
LoadLibraryA I-Entity
. O

It O
was O
left O
inactive O
and O
was O
not O
renewed O
until O
Nov O
12th O
. O

The B-Entity
e-mail I-Entity
has B-Action
two B-Entity
attachments I-Entity
, I-Entity
a I-Entity
non-malicious I-Entity
JPG I-Entity
file I-Entity
and I-Entity
a I-Entity
373 I-Entity
KB I-Entity
Microsoft I-Entity
Word I-Entity
.DOC I-Entity
file I-Entity
. O

We O
have O
been O
able O
to O
acquire O
both O
a O
client O
and O
server O
part O
for O
it O
. O

The O
bit.ly O
service O
does O
however O
provide O
information O
on O
the O
user O
creating O
the O
shortened O
link O
, O
and O
other O
links O
associated O
with O
this O
account O
. O

The O
sample O
, O
which O
was O
deployed O
against O
an O
organization O
involved O
in O
shaping O
economic O
policy O
, O
was O
downloaded O
from O
the O
following O
URL O
: O
The O
sample O
generated O
the O
following O
traffic O
: O
This O
output O
reveals O
the O
following O
changes O
when O
compared O
with O
earlier O
variants O
: O
The O
POST O
URI O
is O
changed O
to O
/bbs/search.asp O
( O
as O
mentioned O
, O
earlier O
Aumlib O
variants O
used O
a O
POST O
URI O
of O
/bbs/info.asp O
. O

For O
this O
reason O
, O
the O
regime O
's O
key O
political O
and O
military O
relationships O
are O
explored O
below O
. O

The O
number O
of O
targeted O
cyberattacks O
in O
general O
has O
risen O
in O
the O
past O
few O
years O
. O

This O
executable O
contains O
the O
aforementioned O
VSVERSIONINFO O
PE O
resource O
. O

Here O
's O
a O
statistic O
on O
the O
injected O
websites O
: O
The O
distribution O
is O
obviously O
not O
random O
, O
and O
it O
reflects O
some O
of O
the O
interests O
of O
the O
attackers O
. O

For O
example O
the O
Hidden O
Lynx O
group O
stopped O
using O
a O
zero-day O
vulnerability O
in O
a O
large O
watering O
hole O
attack O
after O
Microsoft O
released O
details O
on O
the O
vulnerability O
. O

For O
further O
background O
information O
on O
these O
personas O
, O
please O
see O
Appendix O
F O
: O
Personas O
. O

The O
Gen O
2 O
sub-family O
, O
however O
, O
no O
longer O
employs O
network O
stealth O
provided O
by O
the O
Gen O
1 O
network O
driver O
which O
exposes O
the O
C2 O
server O
addresses O
to O
analysts O
. O

An O
album O
in O
this O
site O
named O
'' O
me O
'' O
has O
several O
shots O
of O
what O
is O
likely O
cpyy O
himself O
, O
from O
2005 O
, O
2006 O
, O
and O
2007 O
, O
shown O
to O
the O
right O
: O
An O
account O
on O
rootkit.com O
, O
a O
popular O
low-level O
software O
security O
site O
, O
existed O
for O
user O
cpyy O
and O
was O
accessed O
in O
at O
least O
May O
2004 O
. O

We O
analyze O
an O
extensive O
collection O
of O
suspicious O
files O
and O
links O
targeting O
activists O
, O
opposition O
members O
, O
and O
non- O
governmental O
organizations O
in O
the O
Middle O
East O
over O
the O
past O
several O
years O
. O

It O
should O
be O
noted O
that O
Gpokr.com O
no O
longer O
appears O
to O
be O
serving O
advertisements O
from O
their O
site O
. O

However O
, O
the O
regime O
has O
historically O
failed O
in O
its O
attempts O
at O
large-scale O
production O
of O
electronic O
components O
. O

] O
af O
is O
a O
legitimate O
CDN O
site O
used O
by O
the O
Afghan O
Ministry O
of O
Communications O
and O
IT O
( O
MCIT O
) O
to O
host O
web O
content O
that O
is O
displayed O
and O
used O
on O
many O
official O
gov.af O
websites O
. O

Equipment O
that O
is O
not O
connected O
to O
the O
Internet O
and O
other O
networks O
is O
not O
immune O
to O
threats O
and O
there O
has O
already O
been O
a O
number O
of O
successful O
attacks O
against O
isolated O
systems O
. O

APT3 O
( O
also O
known O
as O
UPS O
) O
, O
the B-Entity
actors I-Entity
responsible I-Entity
for I-Entity
Operation I-Entity
Clandestine I-Entity
Fox I-Entity
has O
quietly O
continued O
to O
send B-Action
waves B-Entity
of I-Entity
spearphishing I-Entity
messages I-Entity
over B-Modifier
the B-Entity
past I-Entity
few I-Entity
months I-Entity
. O

Given O
Operation O
Cleaver's O
frequent O
spin-up O
and O
take-down O
of O
large O
IP O
blocks O
inside O
the O
AFRANET O
IP O
space O
inside O
Iran O
, O
and O
Iran O
's O
well O
recorded O
investment O
in O
cyber O
warfare O
leads O
us O
to O
one O
simple O
conclusion O
: O
Iran O
is O
extremely O
active O
in O
the O
world O
of O
hacking O
. O

The B-Entity
VBScript I-Entity
then O
sets B-Action
a B-Entity
startup I-Entity
key I-Entity
in B-Modifier
the B-Entity
'' I-Entity
HKCU\Software\Microsoft\Windows\CurrentVersion\Run I-Entity
'' I-Entity
registry I-Entity
path I-Entity
to O
execute B-Action
the B-Entity
DLLs I-Entity
at B-Modifier
boot B-Entity
time I-Entity
. O

• O
North O
Korea O
is O
known O
to O
have O
monetary O
deficiencies O
, O
which O
further O
limit O
expansion O
of O
infrastructure O
and O
CNO O
capabilities O
, O
at O
least O
without O
third-party O
aid O
. O

The O
purpose O
of O
this B-Entity
command I-Entity
might O
be O
to O
delete B-Action
older B-Entity
versions I-Entity
of I-Entity
BITTERBUG I-Entity
, O
although O
we O
have O
not O
observed O
this O
command O
occurring O
in O
the O
wild O
. O

There O
are O
also O
issues O
around O
processes O
. O

The O
No O
. O

The O
operational O
security O
exhibited O
by O
the O
attackers O
is O
very O
good O
- O
among O
the O
best O
we O
have O
seen O
. O

The O
prototype O
for O
MatrixMain O
is O
as O
follows O
: O
where O
Arguments O
parameter O
can O
be O
: O
If O
the O
i O
parameter O
is O
given O
, O
the B-Entity
DLL I-Entity
will O
install B-Action
itself B-Entity
as B-Modifier
a B-Entity
service I-Entity
on B-Modifier
the B-Entity
victim I-Entity
's I-Entity
machine I-Entity
. O

North O
Korea O
also O
has O
black O
market O
ties O
to O
Sumiyoshi-kai's O
rival O
syndicate O
, O
Yamaguchi-gumi O
. O

] O
com O
by O
shared O
hosting O
history O
at O
the O
following O
IP O
address O
: O
It O
is O
unclear O
why O
these O
actors O
would O
attack O
an O
IP O
address O
they O
were O
actively O
using O
. O

Tarh O
Andishan O
is O
listed O
as O
the O
registrant O
for O
a O
number O
of O
small O
net O
blocks O
based O
upon O
the O
email O
address O
tarh.andishan O
( O
at O
) O
yahoo.com O
. O

Though O
ad O
libraries O
may O
not O
have O
the O
incentive O
to O
abuse O
users O
' O
private O
and O
sensitive O
data O
, O
this O
is O
not O
the O
case O
with O
the B-Entity
attackers I-Entity
eavesdropping B-Action
or I-Action
hijacking I-Action
the B-Entity
HTTP I-Entity
traffic I-Entity
. O

The O
WHOIS O
Record O
can O
be O
found O
in O
Appendix O
A. O
Rodong.rep.kp O
was O
registered O
using O
the O
same O
loxley.co.th O
email O
address O
and O
is O
also O
administered O
by O
Star O
Joint O
Venture O
Company O
. O

Since O
then O
, O
a O
handful O
of O
different O
versions O
have O
been O
found O
and O
analyzed O
. O

Some O
instances O
appear O
to O
be O
state O
sponsored O
, O
such O
as O
the O
disruption O
of O
the O
Iranian O
nuclear O
program O
by O
the O
Stuxnet O
worm O
in O
2010 O
, O
one O
of O
the O
attacks O
that O
began O
this O
trend O
. O

It O
looks O
for O
the O
tag O
'' O
X O
) O
) O
) O
'' O
on O
the O
page O
( O
MiniDuke O
was O
searching O
for O
'' O
uri O
! O
'' O
in O
previous O
samples O
) O
and O
if O
the O
tag O
is O
found O
it O
decrypts O
a O
URL O
from O
the O
data O
that O
follows O
it O
. O

Given O
that O
that O
it O
has O
been O
over O
a O
year O
since O
the O
Belgacom O
operation O
was O
publicly O
outed O
, O
The O
Intercept O
considers O
it O
likely O
that O
the O
GCHQ/NSA O
has O
replaced O
their O
toolkit O
and O
no O
current O
operations O
will O
be O
affected O
by O
the O
publication O
of O
these O
samples O
. O

More O
recently O
, O
however O
, O
suspected B-Entity
Iranian I-Entity
actors I-Entity
have O
destroyed B-Action
data B-Entity
on B-Modifier
thousands B-Entity
of I-Entity
computers I-Entity
with B-Modifier
the B-Entity
Shamoon I-Entity
virus I-Entity
, O
and O
they O
have O
penetrated O
the O
Navy O
Marine O
Corps O
Intranet O
( O
NMCI O
) O
, O
which O
is O
used O
by O
the O
U.S. O
Navy O
worldwide O
. O

• O
In O
the O
second O
mode O
, O
it B-Entity
uses B-Action
Windows B-Entity
Sockets I-Entity
2 I-Entity
( I-Entity
Winsock I-Entity
) I-Entity
APIs I-Entity
, I-Entity
such I-Entity
as I-Entity
WSAStartup I-Entity
( I-Entity
) I-Entity
, I-Entity
socket I-Entity
( I-Entity
) I-Entity
, I-Entity
connect I-Entity
( I-Entity
) I-Entity
, I-Entity
send I-Entity
( I-Entity
) I-Entity
, I-Entity
etc I-Entity
. O

APT28 O
's O
tools O
are O
suggestive O
of O
the O
group O
's O
skills O
, O
ambitions O
, O
and O
identity O
. O

The O
following O
month O
, O
North O
Korean O
actors O
reportedly O
launched O
a O
DDoS O
attack O
against O
South O
Korea O
's O
Nonghyup O
bank O
. O

The B-Entity
attacks I-Entity
we I-Entity
have I-Entity
documented I-Entity
usually O
involve B-Action
the B-Entity
use I-Entity
of I-Entity
malicious I-Entity
links I-Entity
or I-Entity
e-mail I-Entity
attachments I-Entity
, O
designed O
to O
obtain B-Action
information B-Entity
from B-Modifier
a B-Entity
device I-Entity
. O

When O
the O
VBSript O
is O
run O
it B-Entity
drops B-Action
two B-Entity
files I-Entity
to B-Modifier
disk B-Entity
. O

Command B-Entity
and I-Entity
control I-Entity
server I-Entity
domains I-Entity
are B-Action
shared I-Action
between B-Modifier
Uroburos B-Entity
and I-Entity
ComRAT I-Entity
. O

In O
this O
case O
, O
however O
, O
we O
've O
discovered O
an O
overlap O
in O
the O
tools O
and O
infrastructure O
used O
by O
China-based O
advanced O
persistent O
threat O
( O
APT O
) O
actors O
and O
the O
DDoS O
attack O
activity O
. O

Such O
threats O
spread O
broadly O
and O
might O
impact O
any O
person O
, O
regardless O
of O
their O
employer O
. O

. O

The O
code O
within O
Hikit O
begins O
to O
mature O
but O
the O
overall O
functionality O
does O
not O
expand O
beyond O
the O
original O
set O
of O
commands O
found O
in O
Gen O
1.0 O
. O

The O
March O
2011 O
'' O
10 O
Days O
of O
Rain O
'' O
DDoS O
attacks O
on O
U.S. O
and O
South O
Korean O
sites O
have O
also O
been O
attributed O
to O
the O
actors O
associated O
with O
DarkSeoul O
. O

Security O
researcher O
R136a1 O
aka O
'' O
thegoldenmessenger O
'' O
released O
a O
followup O
blog O
with O
detailed O
analysis O
of O
the O
Greek O
embassy O
compromise O
. O

Perhaps O
the O
simplest O
and O
most O
typical O
ecosystem O
is O
a O
dropper O
and O
a O
backdoor O
that O
are O
used O
together O
. O

Based O
on O
public O
records O
, O
this O
organization O
appears O
to O
be O
a O
legal O
entity O
chartered O
to O
conduct O
business O
in O
Missouri O
. O

The O
VSVERSIONINFO O
PE O
resource O
mentioned O
above O
( O
SHA256 O
5156aca994ecfcb40458ead8c830cd66469d5f5 O
a031392898d323a8d7a7f23d3 O
) O
is O
an O
artifact O
of O
the O
Stealer O
builder O
that O
we O
recovered O
. O

Citizen O
Lab O
research O
using O
the O
TTI O
has O
found O
that O
, O
despite O
low O
levels O
of O
technical O
sophistication O
, O
with O
well-crafted O
social O
engineering O
malware O
attacks O
remain O
highly O
effective O
against O
civil O
society O
groups O
. O

This O
is O
a O
practice O
recently O
illustrated O
through O
the O
deployment O
of O
the O
PlugX O
trojan O
, O
utilising O
DLL B-Entity
load I-Entity
order I-Entity
hijacking B-Action
alongside B-Modifier
a B-Entity
signed I-Entity
( I-Entity
trusted I-Entity
) I-Entity
executable I-Entity
. O

➔ O
The O
12th O
Bureau O
Unit O
61486 O
, O
headquartered O
in O
Shanghai O
, O
is O
widely O
accepted O
to O
be O
China O
's O
primary O
SIGINT O
collection O
and O
analysis O
agency O
, O
supporting O
China O
's O
space O
surveillance O
network O
. O

One O
of O
the O
obvious O
tasks O
performed O
by O
attackers B-Entity
is O
to O
install B-Action
key B-Entity
loggers I-Entity
, O
dump B-Action
local B-Entity
credentials I-Entity
, O
search B-Action
local B-Entity
storage I-Entity
for B-Modifier
saved B-Entity
accounts I-Entity
and O
sniff B-Action
the B-Entity
network I-Entity
for B-Modifier
passwords B-Entity
. O

All O
of O
these O
were O
included O
in O
their O
own O
Binder1 O
instance O
, O
which O
also O
dropped O
Easyresumecreator O
. O

The B-Entity
file I-Entity
is B-Action
downloaded I-Action
Base64-encoded B-Entity
inside B-Modifier
of I-Modifier
the B-Entity
SOAP I-Entity
response I-Entity
. O

For O
example O
, O
the O
message O
headers O
could O
be O
: O
Once O
received B-Action
from B-Modifier
the B-Entity
pipes I-Entity
and O
unwrapped/decoded O
, O
the B-Entity
data I-Entity
is O
then O
handled O
by O
the O
usermode O
DLL O
as O
per O
the O
data O
intention O
- O
whether O
it O
's O
a O
traffic O
sniffing O
task O
, O
a O
peer-2-peer O
client O
logic O
, O
a O
logging O
task O
, O
or O
a O
task O
of O
saving O
received O
files O
into O
the O
virtual O
volumes O
. O

kaJ O
's O
projects O
include O
the O
following O
techniques O
. O

There O
are O
11 O
IP O
addresses O
from O
Chinese O
dynamic O
ADSL O
ranges O
: O
9 O
from O
Fuqing O
( O
Fujian O
province O
) O
, O
one O
from O
Fuzhou O
( O
Fujian O
's O
province O
capital O
) O
and O
one O
from O
Nanchang O
( O
Jiangxi O
's O
province O
capital O
) O
. O

While O
not O
directly O
overlapping O
, O
this O
potential O
infrastructure O
link O
is O
interesting O
, O
as O
VIXEN O
PANDA O
has O
previously O
displayed O
TTPs O
similar O
to O
COMMENT O
PANDA O
( O
other O
CrowdStrike O
reporting O
describes O
VIXEN O
PANDA O
malware O
that O
extracts O
C2 O
commands O
embedded O
between O
delimiters O
in O
web O
content O
) O
, O
and O
has O
extensively O
targeted O
European O
entities O
. O

This O
means O
that O
almost O
anyone O
can O
use O
mini O
power O
plants O
like O
water O
, O
wind O
or O
photovoltaic O
sites O
to O
feed O
energy O
back O
into O
the O
power O
grid O
. O

Regin B-Entity
's I-Entity
C I-Entity
& I-Entity
C I-Entity
operations I-Entity
are B-Action
extensive B-Entity
. O

The O
discovery O
of O
Regin O
serves O
to O
highlight O
how O
significant O
investments O
continue O
to O
be O
made O
into O
the O
development O
of O
tools O
for O
use O
in O
intelligence O
gathering O
. O

[ O
COMPANY-NAME O
] O
.com.exe O

Fully B-Entity
compromised I-Entity
VPN I-Entity
credentials I-Entity
meant B-Action
their B-Entity
entire I-Entity
remote I-Entity
access I-Entity
infrastructure I-Entity
and I-Entity
supply I-Entity
chain I-Entity
was I-Entity
under I-Entity
the I-Entity
control I-Entity
of I-Entity
the I-Entity
Cleaver I-Entity
team I-Entity
, O
allowing B-Action
permanent B-Entity
persistence I-Entity
under B-Modifier
compromised B-Entity
credentials I-Entity
. O

] O
com O
and O
cht O
[ O
. O

Aggressive B-Entity
ad I-Entity
libraries I-Entity
also O
leak B-Action
the B-Entity
user I-Entity
's I-Entity
private I-Entity
information I-Entity
. O

North O
Korea O
considers O
its O
cyber O
warfare O
capabilities O
an O
important O
asymmetric O
asset O
in O
the O
face O
of O
its O
perceived O
enemies O
, O
the O
U.S. O
and O
South O
Korea O
. O

The B-Entity
spear I-Entity
phishing I-Entity
emails I-Entity
came B-Action
from B-Modifier
234 B-Entity
spoofed I-Entity
addresses I-Entity
. O

Here O
, O
we O
will O
use O
a O
relatively O
easy O
way O
-- O
'' O
NSI O
Kernel O
Module O
Dispatch O
Routine O
Hook O
'' O
to O
demonstrate O
the O
specified O
port O
hiding O
uner O
Vista O
. O

In O
a O
recent O
case O
, O
word B-Entity
docs I-Entity
embed- B-Action
ded I-Action
with B-Modifier
0-day B-Entity
flash I-Entity
swf I-Entity
files I-Entity
either O
dropped B-Action
these B-Entity
backdoors I-Entity
or O
downloaded B-Action
and O
executed B-Action
backdoors B-Entity
from B-Modifier
remote B-Entity
web I-Entity
servers I-Entity
. O

They B-Entity
gained B-Action
access B-Entity
to I-Entity
PayPal I-Entity
and I-Entity
Go I-Entity
Daddy I-Entity
credentials I-Entity
allowing B-Action
them B-Entity
to B-Modifier
make B-Entity
fraudulent I-Entity
purchases I-Entity
and O
allowed B-Action
unfettered B-Entity
access I-Entity
to I-Entity
the I-Entity
victim I-Entity
's I-Entity
domains I-Entity
. O

Moreover O
, O
we O
have O
strong O
suspicions O
that O
there O
is O
not O
a O
single O
individual O
nicknamed O
'' O
Trees O
and O
snow O
'' O
but O
rather O
two O
programmers O
nicknamed O
'' O
Trees O
'' O
and O
'' O
Snow O
'' O
. O

The O
AppUsageIds O
for O
these O
versions O
target O
a O
major O
US-based O
university O
as O
well O
as O
an O
Israeli O
aerospace O
company O
. O

This O
smaller O
code O
section O
maintains O
similar O
functionality O
to O
the O
'' O
worm O
'' O
compo- O
nent O
: O
Host B-Entity
package I-Entity
files I-Entity
detected I-Entity
as I-Entity
'' I-Entity
Virus.Win32.Pioneer.dx I-Entity
'' I-Entity
are B-Action
infected B-Entity
legitimate I-Entity
files I-Entity
, O
that O
do O
not O
have O
any O
self­propagation O
routines O
. O

Jimbp O
is O
a O
.NET O

If O
any O
of O
these O
are O
found O
the O
shellcode O
skips O
the O
first O
5 O
bytes O
of O
the O
function O
being O
called O
by O
manually O
executing O
prologue O
instructions O
( O
mov O
edi O
, O
edi O
; O
push O
ebp O
; O
mov O
ebp O
, O
esp O
) O
and O
then O
jumping O
to O
the O
function O
code O
as O
illustrated O
below O
. O

This B-Entity
form I-Entity
, O
like O
the O
rest O
of O
the O
submission O
forms O
, O
only O
stores B-Action
the B-Entity
submitted I-Entity
information I-Entity
while B-Modifier
the B-Entity
application I-Entity
is I-Entity
running I-Entity
. O

The O
Whois O
records O
for O
vpsnoc.com O
revealed O
that O
the O
domain O
was O
registered O
by O
Digital O
Linx O
Hosting O
. O

'' O
For O
example O
, O
we O
found O
a O
list O
of O
sensitive O
Javascript O
interfaces O
that O
are O
publicly O
ex- O
posed O
from O
certain O
versions O
of O
a O
real-world O
ad O
library O
: O
createCalendarEvent O
, O
makeCall O
, O
postToSocial O
, O
sendMail O
, O
sendSMS O
, O
takeCameraPicture O
, O
getGalleryImage O
, O
registerMicListener O
, O
etc O
. O

Disgruntled O
employees O
are O
also O
a O
source O
of O
attacks O
that O
should O
not O
be O
underestimated O
. O

This O
moves O
Gen O
1.2 O
into O
more O
of O
a O
username/password O
authentication O
scheme O
whereas O
previous O
sub-generations O
could O
potentially O
be O
accessed O
by O
accidental O
HTTP O
requests O
. O

This O
malvertising O
was O
from O
the O
same O
IP O
address O
seen O
in O
other O
incidents O
. O

The B-Entity
primary I-Entity
aim I-Entity
of I-Entity
this I-Entity
backdoor I-Entity
is B-Action
remote B-Entity
desktop I-Entity
control I-Entity
functionality I-Entity
comparable I-Entity
to I-Entity
VNC I-Entity
or I-Entity
Remote I-Entity
Desktop I-Entity
over I-Entity
a I-Entity
custom I-Entity
protocol I-Entity
. O

.. O

The O
posting O
indicates O
that O
httpchen O
is O
located O
at O
the O
闵行 O
( O
Minhang O
) O
campus O
of O
SJTU O
and O
was O
posting O
using O
IP O
address O
58.196.156.15 O
, O
which O
is O
associated O
with O
the O
China O
Education O
and O
Research O
Network O
( O
CERNET O
) O
, O
a O
nationwide O
network O
managed O
by O
the O
Chinese O
Ministry O
of O
Education O
. O

This O
allowed O
the B-Entity
attackers I-Entity
to O
use B-Action
infrastructure B-Entity
that I-Entity
was I-Entity
not I-Entity
theirs I-Entity
to B-Modifier
exfiltrate B-Entity
information I-Entity
. O

It B-Entity
drops B-Action
a B-Entity
keylogger I-Entity
. O

For O
some O
of O
the O
C O
& O
C O
servers O
, O
the B-Entity
attackers I-Entity
implemented B-Action
RSA B-Entity
encryption I-Entity
for B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
logs I-Entity
, O
which O
makes O
it O
impossible O
to O
decrypt O
them O
. O

Next O
comes O
'' O
AA O
'' O
, O
'' O
AB O
'' O
and O
so O
on O
, O
until O
'' O
ZZ O
'' O
. O

GCHQ O
declined O
to O
comment O
for O
this O
story O
. O

String O
encryption/decryption O
functions O
use O
the O
following O
keys O
: O
The O
module O
works O
with O
all O
Firefox O
versions O
prior O
to O
Mozilla O
Firefox O
12.0 O
. O

It O
is O
unknown O
if O
the O
attackers O
successfully O
retrieved O
the O
information O
they O
were O
seeking O
, O
if O
they B-Entity
installed B-Action
other B-Entity
back I-Entity
door I-Entity
Trojans I-Entity
or O
gained O
passwords O
that O
allowed O
them O
to O
directly O
access O
the O
computers O
, O
or O
if O
they O
have O
given O
up O
on O
the O
target O
. O

Its O
usage O
of O
a O
Windows O
mailslot O
would O
potentially O
allow O
external B-Entity
binaries I-Entity
to O
write B-Action
data B-Entity
to B-Modifier
the B-Entity
'' I-Entity
checkmesv5555 I-Entity
'' I-Entity
mailslot I-Entity
, O
possibly O
allowing O
CHOPSTICK B-Entity
to O
encrypt B-Action
and O
store O
output B-Entity
from I-Entity
other I-Entity
malware I-Entity
. O

For O
example O
: O
The B-Entity
malware I-Entity
beacons B-Action
location B-Entity
but O
does O
not O
provide O
RAT O
functionality O
. O

Little O
is O
known O
about O
the O
actor O
or O
group O
responsible O
for O
the O
malware O
. O

We O
found O
: O
( O
1 O
) O
3 O
IP O
addresses O
in O
ranges O
registered O
to O
Gamma O
. O

Once O
they O
had O
control O
over O
the O
server O
they B-Entity
used O
common O
hacking O
tools O
to O
harvest B-Action
local B-Entity
passwords I-Entity
, O
dump B-Action
password B-Entity
hashes I-Entity
, O
sniff B-Action
authentication B-Entity
messages I-Entity
and O
exploit O
internal O
active O
directory O
configuration O
. O

In O
each O
instance O
, O
the B-Entity
attacks I-Entity
were B-Action
carried I-Action
out I-Action
by B-Modifier
targeting B-Entity
these I-Entity
Defense I-Entity
contractors I-Entity
directly I-Entity
via I-Entity
real-time I-Entity
ad I-Entity
bidding I-Entity
. O

Type B-Entity
T I-Entity
also O
detects B-Action
the B-Entity
presence I-Entity
of I-Entity
automatic I-Entity
analysis I-Entity
systems I-Entity
or O
debuggers B-Entity
, O
such O
as O
the O
following O
: O
Type O
S O
, O
on O
the O
other O
hand O
, O
was O
used O
only O
twice O
in O
the O
attack O
campaign O
. O

In O
order O
to O
provide O
some O
level O
of O
stealth O
, O
the B-Entity
RAT I-Entity
will O
install B-Action
a B-Entity
rootkit I-Entity
on B-Modifier
32-bit B-Entity
versions I-Entity
of I-Entity
Windows I-Entity
. O

For O
example O
, O
if O
one O
wiper O
variant O
was O
compromised O
or O
detected O
by O
antivirus O
or O
IDS O
signatures O
, O
the O
other O
variants O
may O
have O
differed O
enough O
to O
remain O
undetected O
, O
still O
resulting O
in O
mission O
success O
. O

On O
startup O
, O
the B-Entity
RAT I-Entity
attempts O
to O
create B-Action
a B-Entity
file I-Entity
mapping I-Entity
named I-Entity
& I-Entity
*SDKJfhksdf89*DIUKJDSF I-Entity
& I-Entity
*sdfsdf78sdfsdf I-Entity
. O

In O
Gen O
1.0 O
and O
Gen O
1.1 O
, O
the O
DLL O
instructs O
the O
Driver O
to O
listen O
for O
a O
specific O
string O
( O
typically O
a O
HTTP O
request O
string O
) O
and O
responds O
with O
another O
string O
. O

The O
ldasm O
inline O
hooking O
is O
also O
repeated O
in O
numerous O
postings O
to O
Chinese O
forums O
. O

The B-Entity
communication I-Entity
protocol I-Entity
uses B-Action
requests B-Entity
in B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
replies I-Entity
, O
which O
the B-Entity
malware I-Entity
decrypts B-Action
and I-Action
processes I-Action
. O

North O
Korea O
has O
a O
global O
network O
of O
state-run O
businesses O
located O
in O
30 O
to O
40 O
countries O
that O
is O
used O
for O
espionage O
activities O
. O

The O
name O
of O
the O
file O
is O
randomly O
picked O
from O
the O
following O
values O
( O
you O
can O
find O
this O
listing O
and O
those O
of O
the O
next O
screenshots O
on O
the O
VirusRadar O
description O
: O
The O
filename O
extension O
is O
also O
picked O
randomly O
from O
the O
following O
list O
: O
To O
persist B-Action
on B-Modifier
the B-Entity
infected I-Entity
system I-Entity
after B-Modifier
reboots B-Entity
, O
the B-Entity
malware I-Entity
creates B-Action
a B-Entity
hidden I-Entity
.LNK I-Entity
file I-Entity
in B-Modifier
the B-Entity
'' I-Entity
Startup I-Entity
'' I-Entity
directory I-Entity
pointing O
to O
the O
modified O
main O
module O
. O

Some O
examples O
can O
be O
avstore.com.tw O
, O
sophos.skypetm.com.tw O
, O
symantecs.com.tw O
, O
trendmicro.org.tw O
etc O
. O

During B-Modifier
the B-Entity
first I-Entity
C I-Entity
& I-Entity
C I-Entity
call I-Entity
, O
the B-Entity
backdoor I-Entity
sends B-Action
a B-Entity
pack I-Entity
with I-Entity
the I-Entity
victim I-Entity
's I-Entity
system I-Entity
information I-Entity
. O

The O
most O
interesting O
behaviors O
of O
these O
components O
include O
This O
module O
is O
quite O
small O
( O
27Kb O
) O
and O
comes O
as O
a O
part O
of O
WinRar B-Entity
SFX I-Entity
file I-Entity
that O
drops B-Action
and O
starts B-Action
the B-Entity
module I-Entity
from B-Modifier
% B-Entity
APPDATA I-Entity
% I-Entity
\Microsoft\Crypto\DES64v7\msieckc.exe I-Entity
. O

If O
the O
process O
is O
explorer.exe O
, O
this B-Entity
library I-Entity
will B-Action
load I-Action
the B-Entity
other I-Entity
library I-Entity
called I-Entity
credprov.tlb I-Entity
. O

If O
the O
Driver O
version O
is O
less O
than O
the O
'' O
Transate O
'' O
version O
( O
indicating O
that O
the O
Driver O
is O
a O
version O
too O
old O
to O
support O
the O
necessary O
communication O
protocols O
) O
, O
the O
DLL O
will O
, O
in O
some O
version O
of O
the O
DLL O
, O
print O
out O
a O
line O
to O
the O
screen O
indicating O
the O
DRIVERMINVERSION O
required O
along O
with O
the O
current O
Driver O
version O
. O

As O
a O
precaution O
, O
the B-Entity
sample I-Entity
writes B-Action
settings B-Entity
directly B-Modifier
to I-Modifier
the B-Entity
Windows I-Entity
Registry I-Entity
to O
accomplish O
the O
same O
goal O
if O
installing O
the O
service O
with O
the O
documented O
APIs O
fails O
. O

The O
Cleaver O
campaign O
used O
a O
variety O
of O
methods O
in O
multiple O
stages O
of O
attacks O
. O

5 O
. O

The B-Entity
threat I-Entity
group I-Entity
obfuscated B-Action
the B-Entity
iframe I-Entity
on B-Modifier
two B-Entity
of I-Entity
the I-Entity
compromised I-Entity
websites I-Entity
. O

Stage B-Entity
2 I-Entity
is O
a O
kernel B-Entity
driver I-Entity
that O
simply O
extracts B-Action
, I-Action
installs I-Action
and I-Action
runs I-Action
Stage B-Entity
3 I-Entity
. O

Given O
the O
available O
data O
, O
we O
assess O
that O
APT28 O
's O
work O
is O
sponsored O
by O
the O
Russian O
government O
. O

This O
might O
indicate O
that O
the O
attacker O
's O
operating O
system O
language O
is O
Spanish O
. O

Some O
academic O
work O
looks O
at O
government O
use O
of O
devices O
to O
enable O
censorship O
, O
such O
as O
key- O
word O
blacklists O
for O
Chinese O
chat O
clients O
, O
or O
the O
Green O
Dam O
censorware O
that O
was O
to O
be O
deployed O
on O
all O
new O
computers O
sold O
in O
China O
. O

CHOPSTICK B-Entity
is B-Action
a B-Entity
backdoor I-Entity
that O
uses O
a O
modularized O
, O
object-oriented O
framework O
written O
in O
C++ O
. O

Programs O
at O
the O
Command O
Automation O
University O
include O
command O
automation O
, O
computers O
, O
programming O
, O
automated O
reconnaissance O
, O
and O
electronic O
warfare O
. O

It B-Entity
then O
runs B-Action
rundl132 B-Entity
if B-Modifier
it B-Entity
has I-Entity
not I-Entity
before I-Entity
, O
by O
checking B-Action
whether B-Entity
registry I-Entity
key I-Entity
name I-Entity
'' I-Entity
6 I-Entity
'' I-Entity
is I-Entity
present I-Entity
. O

Upon O
execution O
the B-Entity
binary I-Entity
uses O
its O
hardcoded O
key O
to O
decrypt O
the O
configuration O
section O
and O
retrieve B-Action
the B-Entity
listening I-Entity
port I-Entity
to B-Modifier
use B-Entity
for I-Entity
incoming I-Entity
connections I-Entity
. O

However O
, O
the O
wrapper O
will O
also O
write O
to O
disk O
and O
execute O
the O
second O
executable O
. O

The B-Entity
.scr I-Entity
file I-Entity
was O
a O
self-extracting O
archive O
that O
decompressed O
and O
ran B-Action
both B-Entity
the I-Entity
bait I-Entity
document I-Entity
and I-Entity
the I-Entity
payload I-Entity
. O

The O
conversation O
alludes O
to O
Linxder O
being O
the O
'' O
teacher O
'' O
or O
'' O
landlord O
'' O
and O
the O
other O
aforementioned O
users O
are O
his O
'' O
students O
'' O
. O

The B-Entity
reporter I-Entity
component I-Entity
is O
responsible O
for O
sending B-Action
back B-Modifier
a B-Entity
HTTP I-Entity
GET I-Entity
request I-Entity
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
. O

There O
are O
three O
components O
to O
the O
protocol O
: O
Authentication B-Entity
is B-Action
accomplished I-Action
using B-Modifier
a B-Entity
32 I-Entity
byte I-Entity
packet I-Entity
, O
this O
packet O
consists O
of O
: O
An B-Entity
example I-Entity
authentication I-Entity
packet I-Entity
sent B-Action
to B-Modifier
the B-Entity
C2 I-Entity
is O
located O
in O
Appendix O
E. O
After O
sending B-Action
the B-Entity
initial I-Entity
authentication I-Entity
packet I-Entity
, O
the B-Entity
sample I-Entity
verifies B-Action
that B-Modifier
the B-Entity
first I-Entity
four I-Entity
bytes I-Entity
of I-Entity
the I-Entity
response I-Entity
is I-Entity
equal I-Entity
to I-Entity
a I-Entity
statically I-Entity
defined I-Entity
value I-Entity
, O
in O
this O
sample O
the O
value O
is O
: O
0x16030100 O
. O

Stuart O
is O
founder O
, O
CEO/President O
and O
Chairman O
of O
Cylance O
. O

is B-Action
created I-Action
using B-Modifier
a B-Entity
COM I-Entity
object I-Entity
with B-Modifier
the B-Entity
IShellLinkA I-Entity
interface I-Entity
and O
contains O
the O
following O
command O
: O
'' O
C O
: O
\Windows\system32\rundll32.exe O
% O
pathtomainmodule O
% O
, O
exportfunction O
'' O
Which O
gives O
something O
like O
: O
'' O
C O
: O
\Windows\system32\rundll32.exe O
C O
: O
\DOCUME~1\ALLUSE~1\APPLIC~1\data.cat O
, O
IlqUenn O
'' O
. O

This O
is O
another B-Entity
remote I-Entity
administration I-Entity
tool I-Entity
used B-Action
by O
the B-Entity
Pitty I-Entity
Tiger I-Entity
group I-Entity
. O

• O
The O
infrastructure O
is O
hosted O
through O
Netafraz.com O
, O
an O
Iranian O
provider O
out O
of O
Isfahan O
, O
Iran O
. O

Hence O
, O
the O
numeric O
part O
of O
the O
filename O
is O
used O
as O
a O
seed O
for O
the O
pseudorandom O
number O
generator O
. O

Stage O
4 O
is O
an O
orchestrator O
just O
like O
its O
32-bit O
counterpart O
and O
it O
uses O
the O
same O
major O
and O
minor O
values O
to O
export O
functionality O
. O

The O
sample O
contains O
'dead O
code O
' O
which O
appears O
to O
be O
command O
and O
control O
server O
classes O
, O
this O
is O
likely O
an O
indicator O
that O
the B-Entity
C2 I-Entity
client I-Entity
which I-Entity
would I-Entity
communicate I-Entity
with I-Entity
this I-Entity
sample I-Entity
shares B-Action
the B-Entity
same I-Entity
communications I-Entity
library I-Entity
which I-Entity
was I-Entity
compiled I-Entity
into I-Entity
this I-Entity
sample I-Entity
. O

The O
decoded O
data O
is O
then O
checked O
for O
the O
string O
runshell O
. O

This O
attack O
targets O
one O
of O
the O
ad O
libraries O
described O
in O
this O
paper O
. O

Chongryon O
in O
Japan O
has O
been O
a O
strong O
support O
organization O
aimed O
at O
bringing O
a O
revolution O
in O
South O
Korea O
, O
or O
a O
red O
unification O
by O
force O
. O

TCIRT O
began O
tracking O
a O
set O
of O
activity O
involving O
a O
BITTERBUG O
variant O
in O
May O
2013 O
. O

This O
allowed O
them B-Entity
to O
use B-Action
existing B-Entity
command I-Entity
line I-Entity
utilities I-Entity
available I-Entity
on I-Entity
their I-Entity
targets I-Entity
in O
order O
to O
upload B-Action
information B-Entity
. O

It O
is O
worth O
mentioning O
that O
a O
similar O
scenario O
occurred O
on O
June O
20th O
when O
security O
researcher O
PhysicalDrive0 O
observed O
a O
malicious O
Java O
file O
hosted O
on O
the O
Embassy O
of O
Greece O
in O
Beijing O
. O

McClure O
brings O
over O
two O
decades O
of O
technology O
and O
executive O
leadership O
with O
profound O
technical O
, O
operational O
, O
and O
financial O
experience O
. O

• O
The O
hex O
string O
translates O
to O
'' O
Think O
Evil O
, O
Do O
Good O
'' O
, O
a O
mantra O
our O
research O
team O
lives O
by O
. O

Unfortunately O
, O
the B-Entity
micro-targeting I-Entity
malvertising I-Entity
technique I-Entity
evades B-Action
almost B-Entity
all I-Entity
network I-Entity
controls I-Entity
and I-Entity
traditional I-Entity
endpoint I-Entity
anti-virus I-Entity
solutions I-Entity
. O

In O
the O
spring O
of O
2013 O
, O
Islamists O
and O
Free O
Syrian O
Army O
( O
FSA O
) O
fighters O
took O
over O
Ar- O
Raqqah O
from O
regime O
forces O
. O

These O
first O
three O
bytes O
are O
the O
command O
identifier O
. O

Using B-Modifier
the B-Entity
large-scale I-Entity
traffic I-Entity
intercepted I-Entity
from I-Entity
the I-Entity
above I-Entity
methods I-Entity
, O
attackers B-Entity
can O
iden- B-Action
tify I-Action
potential B-Entity
victims I-Entity
based B-Modifier
on I-Modifier
information B-Entity
leakage I-Entity
such I-Entity
as I-Entity
GPS I-Entity
location I-Entity
described I-Entity
in I-Entity
Sec- I-Entity
tion I-Entity
4.2 I-Entity
. O

One O
interesting O
command O
line O
option O
allows O
the B-Entity
backdoor I-Entity
to O
filter B-Action
the B-Entity
contents I-Entity
of I-Entity
specified I-Entity
files I-Entity
to O
remove B-Action
content B-Entity
using B-Modifier
a B-Entity
regular I-Entity
expression I-Entity
( I-Entity
regex I-Entity
) I-Entity
. O

The B-Entity
threat I-Entity
actors I-Entity
likely O
sought O
to O
infect B-Action
users B-Entity
to I-Entity
these I-Entity
sites I-Entity
for B-Modifier
follow-on B-Entity
data I-Entity
theft I-Entity
, O
including O
information O
related O
to O
defense O
and O
public O
policy O
matters O
. O

For O
more O
information O
on O
how O
the O
Cylance O
Professional O
Services O
team O
can O
assess O
and O
respond O
to O
attacks O
like O
the O
ones O
obseved O
in O
Operation O
Cleaver O
, O
contact O
sales O
@ O
cylance.com O
today O
. O

Logger O
module O
is O
a O
component O
of O
the O
PVZ O
( O
PVZ O
is O
shorthand O
for O
Parviz O
, O
one O
of O
the O
members O
of O
the O
Cleaver O
team O
) O
bot O
tool O
chain O
. O

Its O
encryption O
algorithm O
is O
similar O
to O
RC4 O
. O

The O
subdomains O
associated O
with O
these O
domains O
via O
DNS O
records O
, O
along O
with O
some O
of O
the O
domain O
names O
themselves O
, O
point O
to O
some O
areas O
of O
interest O
for O
the O
PUTTER O
PANDA O
operators O
( O
see O
also O
Droppers O
in O
the O
following O
Technical O
Analysis O
section O
) O
: O
• O
Space O
, O
satellite O
, O
and O
remote O
sensing O
technology O
( O
particularly O
within O
Europe O
) O
; O
• O
Aerospace O
, O
especially O
European O
aerospace O
companies O
; O
• O
Japanese O
and O
European O
telecommunications O
. O

There O
is O
, O
however O
, O
evidence O
that O
the O
development O
of O
Hikit O
Gen O
1 O
and O
Gen O
2 O
overlap O
by O
several O
months O
. O

Merely O
visiting B-Entity
any I-Entity
ad-supported I-Entity
site I-Entity
may O
result B-Action
in B-Modifier
a B-Entity
CryptoWall I-Entity
ransomware I-Entity
infection I-Entity
. O

Exploitation O
of O
captured O
data O
: O
Since O
we O
suspected O
the O
spy- O
ware O
operator O
would O
likely O
seek O
to O
exploit O
captured O
credentials O
, O
particularly O
those O
associated O
with O
Bahraini O
activist O
organiza- O
tions O
, O
we O
worked O
with O
Bahrain O
Watch O
, O
an O
activist O
organization O
inside O
Bahrain O
. O

Both O
versions O
contain O
debugging/progress O
messages O
such O
as O
'' O
down O
file O
success O
'' O
. O

However O
, O
it O
is O
unknown O
whether O
the O
same O
process O
still O
applies O
. O

This O
campaign O
matches O
the O
characteristics O
described O
by O
Proofpoint O
in O
its O
blog O
in O
terms O
of O
the O
exploitation O
methods O
. O

The O
first O
attack O
of O
the O
campaign O
can O
be O
traced O
back O
to O
at O
least O
2011 O
. O

This O
IP O
address O
belongs O
to O
an O
ADSL O
dynamic O
pool O
in O
the O
Wuhan O
area O
( O
Hubei's O
provincial O
capital O
) O
. O

According O
to O
Mitsuhiro O
Suganuma O
, O
former O
section O
head O
of O
the O
second O
intelligence O
department O
of O
the O
Japanese O
Public O
Security O
Intelligence O
Agency O
( O
PSIA O
) O
, O
'' O
Chongryon O
is O
virtually O
under O
the O
direct O
control O
of O
the O
Liaison O
Department O
of O
the O
Workers O
' O
Party O
of O
Korea O
, O
which O
has O
been O
in O
charge O
of O
North O
Korea O
's O
covert O
operations O
and O
underground O
activities O
against O
South O
Korea O
. O

The O
code O
within O
the O
Flash O
files O
from O
each O
attack O
are O
extremely O
similar O
. O

Simply O
halting O
execution O
before O
this O
function O
call O
permits O
a O
researcher O
to O
extract O
the O
reconstructed O
DLL O
from O
memory O
. O

Over O
time O
the O
downloader O
has O
evolved O
and O
the O
newer O
versions O
, O
usually O
compiled O
with O
the O
DLL O
name O
'coreshell.dll O
' O
, O
are O
distinct O
enough O
from O
the O
older O
versions O
that O
we O
refer O
to O
it O
as O
SOURFACE/CORESHELL O
or O
simply O
CORESHELL O
. O

As O
reported O
earlier O
this O
year O
, O
Agent.BTZ O
used O
the O
same O
encoding O
key O
and O
the O
installation O
log O
file O
name O
as O
Uroburos O
. O

175.45.176.0/22 O
is O
North O
Korea O
's O
own O
IP O
block O
. O

Regin O
infections O
have O
been O
observed O
in O
a O
variety O
of O
organizations O
, O
including O
private O
companies O
, O
government O
entities O
, O
and O
research O
institutes O
. O

Another O
account O
linked O
to O
al9mood O
targeted O
@ O
YLUBH O
, O
the O
Twitter O
account O
of O
Yokogawa O
Union O
, O
a O
trade O
union O
at O
the O
Bahraini O
branch O
of O
a O
Japanese O
company O
. O

Whenever O
the B-Entity
underlying I-Entity
miniport I-Entity
driver I-Entity
receives B-Action
data B-Entity
from B-Modifier
the B-Entity
network I-Entity
, O
it B-Entity
calls O
NDIS O
by O
invoking B-Action
a B-Entity
data I-Entity
receive I-Entity
indication I-Entity
function I-Entity
NdisMIndicateReceiveNetBufferLists I-Entity
( I-Entity
) I-Entity
. O

The O
'' O
B O
'' O
tag O
labels O
unwanted O
checkins O
from O
Trend O
Micro O
IP O
ranges O
. O

4 O
. O

This O
helps O
a O
buyer O
learn O
much O
more O
about O
a O
particular O
user O
and O
a O
particular O
impression O
, O
gain O
a O
smarter O
answer O
to O
the O
three O
essential O
questions O
and O
make O
a O
more O
data-driven O
decision O
. O

The O
'' O
P O
'' O
field O
is O
the O
language O
ID O
. O

The O
malware O
uses O
the O
random O
output O
to O
create O
what O
is O
known O
as O
an O
InitVector O
- O
a O
starting O
point O
for O
the O
AES O
encryption/decryption O
function O
. O

We O
believe O
that O
if O
the O
operation O
is O
left O
to O
continue O
unabated O
, O
it O
is O
only O
a O
matter O
of O
time O
before O
the O
world O
's O
physical O
safety O
is O
impacted O
by O
it O
. O

Reports O
about O
ISIS O
targeting O
Internet O
cafés O
have O
grown O
increasingly O
common O
, O
and O
in O
some O
cases O
reports O
point O
to O
the O
possible O
use O
of O
keyloggers O
as O
well O
as O
unspecified O
'' O
IP O
sniffers O
'' O
to O
track O
behaviour O
in O
Internet O
cafes O
. O

'' O
We O
believe O
that O
activists O
and O
journalists O
in O
such O
countries O
may O
experience O
harassment O
or O
consequences O
to O
life O
or O
liberty O
from O
government O
surveillance O
. O

The O
password O
is O
decrypted O
after O
being O
extracted O
. O

Many O
of O
APT28 O
's O
targets O
align O
generally O
with O
interests O
that O
are O
typical O
of O
any O
government O
. O

In O
an O
interview O
given O
to O
the O
Belgian O
magazine O
MondiaalNiews O
, O
Fabrice O
Clément O
, O
head O
of O
security O
of O
Belgacom O
, O
said O
that O
the O
company O
first O
identified O
the O
attack O
on O
June O
21 O
, O
2013 O
. O

However O
, O
without O
Java O
VM O
instances O
, O
it O
's O
difficult O
to O
take O
pictures O
and O
record O
videos O
. O

It O
is O
believed O
that O
a O
status O
request O
command O
packet O
, O
which O
was O
broadcast O
from O
a O
German O
gas O
company O
as O
a O
test O
for O
their O
newly O
installed O
network O
branch O
, O
found O
its O
way O
into O
the O
systems O
of O
the O
Austrian O
energy O
power O
control O
and O
monitoring O
network O
. O

] O
com O
found O
in O
the O
Palo O
Alto O
Networks O
blog O
post O
Attacks O
on O
East O
Asia O
using O
Google O
Code O
for O
Command O
and O
Control O
and O
associated O
with O
Operation O
Poisoned O
Hurricane O
. O

Once O
this O
is O
complete O
, O
it B-Entity
then O
continues O
to O
scan B-Action
a B-Entity
set I-Entity
of I-Entity
configured I-Entity
IP I-Entity
addresses I-Entity
on B-Modifier
the B-Entity
local I-Entity
subnet I-Entity
to B-Modifier
determine B-Entity
which I-Entity
IP I-Entity
addresses I-Entity
have I-Entity
SMB I-Entity
related I-Entity
ports I-Entity
open I-Entity
. O

The O
search O
query O
changes O
roughly O
every O
seven O
days O
and O
is O
similar O
to O
the O
backup O
mechanism O
in O
previous O
versions O
that O
was O
using O
Google O
searches O
. O

From O
this O
packet O
we O
can O
tell O
the O
device O
's O
screen O
density O
( O
d-device-screen-density O
) O
, O
screen O
size O
( O
d-device- O
screen-size O
) O
, O
host O
app O
's O
pack- O
age O
name O
( O
u-appBId O
) O
, O
host O
app O
's O
name O
( O
u-appDNM O
) O
1 O
, O
host O
app O
's O
version O
( O
u-appVer O
) O
, O
user O
agent O
( O
h-user-agent O
) O
, O
localization O
( O
d-localization O
) O
, O
mobile O
network O
type O
( O
d-netType O
) O
, O
screen O
orientation O
( O
d-orientation O
) O
, O
and O
GPS O
location O
( O
u-latlong-accu O
) O
. O

This B-Entity
one I-Entity
is O
also O
used O
by O
the O
group O
to O
infect B-Action
workstations B-Entity
, O
collect B-Action
system B-Entity
information I-Entity
, O
and O
install B-Action
more B-Entity
malware I-Entity
on B-Modifier
the B-Entity
infected I-Entity
computer I-Entity
. O

Juche O
is O
the O
official O
political O
ideology O
of O
North O
Korea O
. O

There O
are O
a B-Entity
few I-Entity
well-known I-Entity
tools I-Entity
which O
are O
capable O
of O
doing O
this O
given B-Action
sufficient B-Entity
privileges I-Entity
on I-Entity
the I-Entity
infected I-Entity
host I-Entity
. O

It O
is O
well O
known O
that O
communication O
via O
HTTP O
is O
prone O
to O
hijacking O
and O
data O
tamper- O
ing O
. O

After O
stealing B-Action
secrets B-Entity
from B-Modifier
local B-Entity
system I-Entity
the B-Entity
malware I-Entity
executes B-Action
some B-Entity
kind I-Entity
of I-Entity
embedded I-Entity
script I-Entity
. O

This B-Entity
component I-Entity
is O
a O
virus O
, O
and O
is O
used O
to O
selectively O
infiltrate B-Action
into B-Modifier
other B-Entity
comput- I-Entity
ers I-Entity
via B-Modifier
USB B-Entity
or O
network B-Entity
shares I-Entity
. O

As O
with O
the O
4H O
RAT O
, O
the B-Entity
C2 I-Entity
protocol I-Entity
used B-Action
by O
the B-Entity
3PARA I-Entity
RAT I-Entity
is B-Action
HTTP B-Entity
based I-Entity
, O
using B-Action
both O
GET B-Entity
and O
POST B-Entity
requests I-Entity
. O

The O
bot O
then O
visits O
the O
Twitter O
profiles O
returned O
by O
the O
search O
and O
looks O
for O
links O
that O
end O
with O
'' O
.xhtml O

By O
using B-Action
IP B-Entity
address I-Entity
filters I-Entity
before B-Modifier
infecting B-Entity
any I-Entity
visitor I-Entity
of I-Entity
such I-Entity
sites I-Entity
, O
the B-Entity
attacker I-Entity
can O
reduce O
the O
number O
of O
infected O
systems O
and O
bring O
it O
to O
a O
manageable O
quantity O
which O
can O
be O
assessed O
manually O
at O
another O
time O
. O

'' O
We O
created O
an O
additional O
fingerprint O
based O
on O
the O
proxying O
behavior O
and O
is- O
sued O
GET O
/search O
? O
q=ip+address O
& O
nord=1 O
requests O
to O
servers O
We O
note O
some O
interesting O
master O
locations O
in O
Table O
4 O
. O

The O
fact O
that O
most O
of O
the O
time O
the O
victims O
are O
top O
executives O
indicates O
the O
attackers O
have O
knowledge O
of O
their O
victims O
whereabouts O
, O
including O
name O
and O
place O
of O
stay O
. O

This O
section O
describes O
a B-Entity
highly I-Entity
targeted I-Entity
attack I-Entity
sent B-Action
to B-Modifier
an B-Entity
e-mail I-Entity
address I-Entity
belonging I-Entity
to I-Entity
RSS I-Entity
. O

The O
domain O
hackingteam.it O
resolves O
to O
an O
address O
in O
this O
range O
. O

The O
regime O
indicated O
refusal O
to O
comply O
with O
any O
UN O
agreements O
regarding O
nuclear O
weaponry O
and O
announced O
it O
would O
reinstate O
its O
nuclear O
materials O
production O
. O

One O
of O
the O
keys O
to O
Regin O
is O
its O
stealth O
: O
To O
avoid B-Action
detection B-Entity
and O
frustrate B-Action
analysis B-Entity
, O
malware B-Entity
used O
in O
such O
operations O
frequently O
adhere O
to O
a O
modular O
design O
. O

The O
following O
report O
is O
a O
product O
of O
collaborative O
research O
and O
threat O
intelligence O
sharing O
between O
Cyber O
Squared O
Inc. O
's O
TCIRT O
and O
FireEye O
Labs O
. O

In O
2001 O
an O
attack O
took O
place O
against O
California O
's O
power O
distribution O
center O
, O
which O
controls O
the O
flow O
of O
electricity O
across O
California O
. O

Foreign O
news O
and O
opposition O
websites O
are O
routinely O
blocked O
in O
Iran O
, O
as O
are O
the O
tools O
that O
allow O
users O
in O
Iran O
to O
bypass O
these O
restrictions O
. O

'' O
Here O
are O
some O
notes O
on O
the O
costs O
and O
technical O
requirements O
of O
attacking O
these O
certificates O
. O

The O
first O
section O
of O
this O
report O
gives O
an O
overview O
of O
the O
samples O
collected O
, O
where O
they O
were O
reported O
and O
the O
timelines O
derived O
from O
their O
analysis O
. O

We O
also O
found O
another O
malware O
, O
named O
'' O
Troj/ReRol.A O
'' O
. O

Platforms O
used O
by O
potential O
targets O
, O
such O
as O
GMail O
, O
Twitter O
, O
and O
Facebook O
increasingly O
make O
transport- O
layer O
encryption O
the O
default O
, O
obscuring O
communications O
from O
most O
network O
surveillance O
. O

In O
its O
communication O
protocol O
with O
the O
driver O
it O
uses O
the O
IOCTL O
code O
of O
0x222038 O
. O

It B-Entity
is O
also O
sophisticated O
, O
using B-Action
complex B-Entity
techniques I-Entity
for B-Modifier
evading B-Entity
host I-Entity
defences I-Entity
and O
providing B-Action
the B-Entity
attackers I-Entity
covert B-Entity
communication I-Entity
channels I-Entity
. O

Identify O
critical O
systems O
and O
evaluate O
the O
need O
for O
having O
on-hand O
spares O
to O
quickly O
restore O
service O
. O

HTTP B-Entity
communications I-Entity
are B-Action
often I-Action
used I-Action
by O
botnets B-Entity
, O
but O
it O
is O
uncommon O
to O
use O
a O
sub-protocol O
such O
as O
SOAP O
. O

The O
end O
result O
is O
that O
the O
value O
of O
f O
is O
also O
changed O
in O
the O
SHA-1 O
function O
which O
affects O
the O
value O
of O
the O
2nd O
word O
for O
that O
round O
and O
ultimately O
the O
whole O
hash O
for O
long O
messages O
. O

] O
com O
. O

The O
code O
base O
for O
the O
sample O
was O
developed O
in O
C++ O
. O

There O
are O
some O
important O
differences O
though O
, O
especially O
in O
the O
encryption O
algorithms O
used O
– O
RC4 O
in O
RedOctober O
vs O
AES O
in O
Cloud O
Atlas O
. O

The O
function O
of O
the B-Entity
malware I-Entity
appears O
to O
be O
: O
identify B-Action
and I-Action
unmask I-Action
the B-Entity
IP I-Entity
address I-Entity
of I-Entity
target I-Entity
( I-Entity
s I-Entity
) I-Entity
, O
and O
resend B-Action
them B-Entity
to B-Modifier
the B-Entity
attacker I-Entity
with B-Modifier
each I-Modifier
reboot B-Entity
. O

( O
Reason O
Magazine O
is O
a O
US-based O
magazine O
) O
The O
letter O
welcomed O
the O
individual O
as O
a O
contributor O
and O
requested O
topic O
ideas O
and O
identification O
information O
in O
order O
to O
establish O
him O
at O
the O
magazine O
. O

Once O
this O
happens O
, O
there O
are O
no O
remaining O
plainly O
visible O
code O
artifacts O
. O

Contact O
: O
intelreports O
@ O
kaspersky.com O
We O
would O
like O
to O
add O
the O
following O
at O
the O
end O
of O
the O
blogpost O
, O
right O
before O
the O
detection O
names O
: O
If O
you O
'd O
like O
to O
read O
more O
about O
Turla/Uroburos O
, O
here O
's O
a O
few O
recommendations O
: O
Context O
Information O
Security O
distribute O
Context O
Threat O
Intelligence O
( O
CTI O
) O
reporting O
under O
the O
Traffic O
Light O
Protocol O
( O
TLP O
) O
, O
a O
method O
of O
classifying O
a O
document O
in O
order O
to O
promote O
the O
distribution O
of O
sensitive O
information O
between O
individuals O
, O
organisations O
or O
communities O
in O
a O
controlled O
and O
trusted O
way O
, O
based O
on O
the O
originator O
's O
wishes O
. O

We O
searched O
sources O
including O
Shodan O
, O
5 O
Internet O
Census O
service O
probes O
, O
and O
Critical.IO O
scanning O
data O
for O
the O
observed O
distinctive O
HTTP O
behavior O
. O

Interestingly O
, O
the O
malware O
stores O
the O
first O
four O
bytes O
rotated O
right O
by O
seven O
bits O
and O
compares O
that O
value O
to O
the O
seven O
bits O
rotated O
right O
version O
of O
the O
server O
's O
response O
, O
effectively O
neutralizing O
the O
rotation O
's O
effect O
; O
the O
purpose O
of O
this O
is O
unclear O
. O

. O

All O
the O
e-mail O
addresses O
used O
are O
connected O
to O
the O
Pitty O
Tiger O
group O
. O

This O
would O
give O
the O
same O
access O
to O
resources O
accessible O
from O
the O
Squid O
proxy O
server O
to O
this O
Iranian O
IP O
address O
. O

On O
the O
contrary O
, O
taking O
pictures O
and O
recording O
videos O
are O
more O
challenging O
. O

We O
denote O
this O
combination O
as O
the O
3-Stage O
Ex- O
ploit O
Kit O
in O
Figure O
5 O
. O

We O
identified O
several O
server O
groups O
that O
may O
be O
associated O
with O
victims O
or O
operators O
in O
a O
certain O
country O
. O

Twitter O
described O
its O
enhanced O
as O
'' O
part O
of O
improved O
targeting O
options O
to O
help O
advertisers O
reach O
additional O
users O
similar O
to O
their O
existing O
audiences O
. O

The O
downloaded O
sccm.exe O
is O
written O
using O
Visual O
C++ O
6 O
; O
and O
has O
a O
PE O
header O
compile O
date O
of O
October O
2010 O
. O

There O
have O
already O
been O
proof O
of O
concept O
attacks O
that O
demonstrate O
how O
smart B-Entity
meters I-Entity
could O
be B-Action
manipulated I-Action
to B-Modifier
send B-Entity
back I-Entity
false I-Entity
information I-Entity
or I-Entity
report I-Entity
incorrect I-Entity
billing I-Entity
IDs I-Entity
, I-Entity
leading I-Entity
to I-Entity
power I-Entity
theft I-Entity
. O

The O
system O
information O
could O
be O
used O
to O
identify O
processes O
to O
exploit O
in O
the O
future O
, O
however O
since O
the B-Entity
attacker I-Entity
has O
already O
triggered B-Action
the B-Entity
execution I-Entity
of I-Entity
a I-Entity
file I-Entity
on I-Entity
the I-Entity
victim I-Entity
's I-Entity
system I-Entity
, O
it O
is O
surprising O
that O
more O
was O
not O
taken O
, O
or O
that O
a O
RAT O
( O
custom O
or O
widely O
available O
) O
was O
not O
used O
. O

The O
functionality O
of O
the B-Entity
shellcode I-Entity
which O
is B-Action
executed I-Action
by B-Modifier
triggering B-Entity
the I-Entity
vulnerability I-Entity
is O
rather O
simple O
and O
straightforward O
. O

It O
's O
worth O
noting O
that O
Agent.BTZ B-Entity
used B-Action
the B-Entity
same I-Entity
XOR I-Entity
key I-Entity
for B-Modifier
its B-Entity
logs I-Entity
as O
the O
most O
recent O
variants O
: O
Log B-Entity
files I-Entity
created B-Action
by O
the B-Entity
latest I-Entity
samples I-Entity
of I-Entity
Snake I-Entity
, O
compiled O
in O
2013 O
and O
2014 O
, O
were O
successfully O
decrypted O
with O
the O
same O
XOR O
key O
. O

Kaspersky O
products O
detect O
the O
malware O
from O
the O
Cloud O
Atlas O
toolset O
with O
the O
following O
verdicts O
: O
Blue O
Coat O
Exposes O
Inception O
Framework O
It O
's O
friday O
afternoon O
, O
I O
had O
a O
bit O
of O
free O
time O
and O
stumbled O
across O
this O
tweet O
by O
PhysicalDrive0 O
( O
thx O
! O
) O
two O
hours O
ago O
and O
thought O
to O
give O
it O
a O
try O
to O
finally O
add O
a O
new O
article O
to O
this O
Blog O
( O
first O
of O
2014 O
) O
: O
So O
, O
I O
went O
to O
Google O
to O
search O
for O
the O
domain O
of O
the O
Embassy O
of O
Greece O
Beijing O
and O
added O
the O
( O
allegedly O
) O
malicious O
java O
file O
package O
that O
was O
found O
by O
PhysicalDrive0 O
: O
Next O
, O
I O
loaded O
the O
1.jar O
file O
into O
Java O
Decompiler O
to O
get O
the O
source O
code O
. O

Police O
questioning O
revolved O
around O
Tweets O
that O
referred O
to O
Bahrain O
's O
King O
as O
a O
'' O
cursed O
one O
. O

Children O
aged O
14-16 O
can O
begin O
military O
training O
as O
members O
of O
the O
Young O
Red O
Guards O
, O
a O
paramilitary O
unit O
. O

Operation O
Cleaver O
's O
intense O
focus O
on O
critical O
infrastructure O
companies O
, O
especially O
in O
South O
Korea O
, O
hints O
at O
information O
sharing O
or O
joint O
operations O
with O
Iran O
's O
partner O
, O
North O
Korea O
. O

Aumlib B-Entity
, O
which O
for O
years O
has O
been O
used O
in O
targeted O
attacks O
, O
now O
encodes B-Action
certain B-Entity
HTTP I-Entity
communications I-Entity
. O

It O
just O
takes O
a O
few O
lines O
of O
code O
in O
the O
infecting O
script O
to O
only O
compromise B-Action
visitors B-Entity
coming I-Entity
from I-Entity
the I-Entity
target I-Entity
IP I-Entity
ranges I-Entity
. O

The B-Entity
polymorphing I-Entity
mechanism I-Entity
also O
generates O
, O
and O
inserts O
, O
unique O
functions O
all O
of O
which O
make O
calls O
to O
different O
floating-point O
operations O
– O
all O
done O
just O
to O
obfuscate B-Action
the B-Entity
actual I-Entity
decoding I-Entity
process I-Entity
. O

The O
following O
September O
of O
2013 O
, O
the O
Wall O
Street O
Journal O
accused O
Iran O
of O
hacking O
into O
unclassified O
U.S. O
Navy O
computers O
in O
San O
Diego O
's O
NMCI O
( O
Navy O
Marine O
Corp O
Intranet O
) O
,5 O
which O
we O
can O
confirm O
was O
part O
of O
Operation O
Cleaver O
. O

This O
allows O
the B-Entity
attackers I-Entity
to O
uniquely O
identify B-Action
every B-Entity
targeted I-Entity
attack I-Entity
and O
track O
how O
successful O
each O
phishing O
campaign O
is O
. O

Furthermore O
they O
may O
deploy O
new O
technology O
which O
might O
be O
untested O
and O
contain O
some O
unknown O
vulnerabilities O
. O

To O
enable O
rapid O
response O
, O
the O
following O
Snort O
signature O
can O
be O
deployed O
: O
Additionally O
, O
the O
following O
Yara O
signature O
should O
identify O
both O
encoded O
payloads O
and O
the O
active O
implant O
in O
memory O
: O
In O
February O
2014 O
, O
the O
experts O
of O
the O
G O
DATA O
SecurityLabs O
published O
an O
analysis O
of O
Uroburos O
, O
the O
rootkit O
with O
Russian O
roots O
. O

2 O
. O

Symantec O
has O
assigned O
these O
version O
identifiers O
as O
they O
are O
the O
only O
two O
versions O
that O
have O
been O
acquired O
. O

Much O
like O
PVZ-In O
, O
this B-Entity
command I-Entity
and I-Entity
control I-Entity
channel I-Entity
communicates B-Action
with B-Modifier
the B-Entity
Content-Disposition I-Entity
HTTP I-Entity
header I-Entity
, O
but O
for B-Modifier
file B-Entity
data I-Entity
, O
POST B-Entity
data I-Entity
is B-Action
supplied I-Action
. O

They O
published O
a O
similar O
mechanism O
in O
June O
2014 O
. O

After O
extracting O
these O
connection O
and O
server O
details O
, O
the B-Entity
dropper I-Entity
uses O
the O
previously O
dropped O
alg O
. O

The O
main O
implant O
code O
is O
stored O
in O
files O
named O
instructions.pdf O
and O
instructions64.pdf O
; O
not O
PDF O
documents O
but O
instead O
DLLs B-Entity
obfuscated B-Action
with B-Modifier
a B-Entity
one-byte I-Entity
XOR I-Entity
with I-Entity
0x14 I-Entity
, O
similar O
to O
the O
malware O
loader O
DLLs O
. O

Existing O
reactive O
solutions O
rely O
on O
a O
constant O
stream O
of O
signature O
updates O
for O
threat O
detection O
, O
which O
is O
not O
only O
costly O
and O
inconvenient O
, O
but O
also O
requires O
'' O
sacrificial O
lambs O
'' O
. O

Many O
of O
these O
psychological O
operations O
campaigns O
are O
politically O
focused O
. O

If O
the O
input O
is O
not O
in O
this O
list O
of O
built-in O
commands O
, O
the B-Entity
malware I-Entity
attempts O
to O
invoke B-Action
cmd.exe B-Entity
in B-Modifier
the B-Entity
background I-Entity
, O
launching B-Action
a B-Entity
command I-Entity
or I-Entity
command I-Entity
line I-Entity
utility I-Entity
already I-Entity
present I-Entity
on I-Entity
the I-Entity
system I-Entity
. O

Using B-Entity
an I-Entity
IOS I-Entity
User-Agent I-Entity
triggered B-Action
the B-Entity
download I-Entity
of I-Entity
a I-Entity
Debian I-Entity
installer I-Entity
package I-Entity
, I-Entity
WhatsAppUpdate.deb I-Entity
, O
also O
1.2Mb O
in O
size O
. O

In O
fact O
, O
they O
can O
even O
send O
just O
a O
single O
e-mail O
. O

For O
these O
reasons O
, O
it O
seems O
unlikely O
that O
the O
RAONASRT O
WhoIs O
Team O
would O
maliciously O
target O
South O
Korean O
entities O
. O

This O
vulnerability O
, O
named O
CVE-2014-1761 O
( O
Microsoft O
Word O
RTF O
Object O
Confusion O
) O
, O
had O
already O
been O
used O
effectively O
by O
attackers O
at O
the O
time O
of O
the O
announcement O
. O

Article O
106 O
of O
North O
Korea O
's O
Constitution O
gives O
the O
NDC O
the O
following O
powers O
: O
 O
The O
power O
to O
establish O
policies O
of O
the O
state O
in O
accordance O
with O
the O
military-first O
revolutionary O
line O
. O

No O
matter O
the O
strategy O
, O
this O
actor O
has O
shown O
an O
ability O
to O
operate O
successfully O
. O

Memory O
pipes O
is O
a O
common O
mechanism O
for O
Inter-Process O
Communications O
( O
IPC O
) O
. O

Currently O
, O
the O
largest O
number O
of O
injected O
sites O
is O
in O
Romania O
. O

Ensure O
antivirus O
is O
up O
to O
date O
. O

• O
Digital O
Linx O
founder O
Muhammad O
Naseer O
Bhatti O
had O
at O
least O
a O
working O
relationship O
with O
VPNSOC O
employee O
Abunasar O
Khan O
– O
connected O
through O
domain O
registrations O
and O
a O
common O
Google+ O
profile O
for O
Shoaib O
Riaz O
( O
another O
Digital O
Linx O
employee O
) O
. O

In O
what O
is O
certainly O
not O
a O
coincidence O
, O
we O
also O
observed O
www.arce B-Entity
[ I-Entity
. I-Entity
] I-Entity
org I-Entity
( O
one O
of O
the O
sites O
redirecting B-Action
to B-Modifier
the B-Entity
current I-Entity
Flash I-Entity
exploit I-Entity
) O
also O
redirect B-Action
visitors B-Entity
to B-Modifier
the B-Entity
Java I-Entity
exploit I-Entity
on I-Entity
shop.fujifilm I-Entity
[ I-Entity
. I-Entity
] I-Entity
be I-Entity
in B-Modifier
2013 B-Entity
. O

The O
hacking O
operations O
against O
Belgacom O
and O
the O
European O
Union O
were O
first O
revealed O
last O
year O
through O
documents O
leaked O
by O
NSA O
whistleblower O
Edward O
Snowden O
. O

This B-Entity
tool I-Entity
includes O
functionality O
to O
open B-Action
ports B-Entity
in B-Modifier
a B-Entity
victim I-Entity
host I-Entity
's I-Entity
firewall I-Entity
and O
take O
advantage O
of O
universal O
Plug O
and O
Play O
( O
UPNP O
) O
mechanisms O
to O
discover B-Action
routers B-Entity
and I-Entity
gateway I-Entity
devices I-Entity
, O
and O
add B-Action
port B-Entity
mappings I-Entity
, O
allowing B-Action
inbound B-Entity
connections I-Entity
to B-Modifier
victim B-Entity
hosts I-Entity
on B-Modifier
Network B-Entity
Address I-Entity
Translated I-Entity
( I-Entity
NAT I-Entity
) I-Entity
private I-Entity
networks I-Entity
. O

An O
additional O
method O
was O
used O
for O
earlier O
versions O
. O

Their O
location O
and O
exact O
membership O
, O
however O
, O
is O
secret O
. O

It B-Entity
is O
also O
capable O
of O
removing B-Action
some B-Entity
older I-Entity
components I-Entity
, O
the O
names O
of O
which O
are O
hardcoded O
in O
the O
body O
of O
the O
malware O
. O

If O
you O
are O
using O
an O
out-of-date O
Microsoft O
Office O
2007 O
or O
2010 O
, O
update O
Microsoft O
Office O
to O
the O
latest O
version O
. O

The O
use O
of O
RATs O
against O
the O
opposition O
has O
been O
a O
well- O
documented O
feature O
of O
the O
Syrian O
Civil O
War O
since O
the O
first O
re- O
ports O
were O
published O
in O
early O
2012 O
[ O
, O
, O
, O
, O
] O
. O

We O
run O
the O
targeting O
specifics O
against O
our O
proprietary O
database O
and O
create O
a O
custom O
IP O
list O
to O
target O
against O
. O

• O
% O
System O
% O
\config\SecurityAudit.Evt O
: O
Contains O
a O
user O
mode O
version O
of O
Stage O
3 O
. O

Others O
domain O
seen O
resolving O
to O
this O
same O
/24 O
subnet O
were O
dll O
[ O
. O

Red O
Star O
OS O
is O
only O
offered O
in O
the O
Korean O
language O
and O
features O
proprietary O
software O
including O
Naenara O
( O
a O
Firefox-based O
browser O
) O
, O
as O
well O
as O
a O
text O
editor O
, O
email O
client O
, O
audio O
and O
video O
players O
, O
and O
games O
. O

The O
profile O
on O
this O
blog O
( O
shown O
in O
Figure O
2 O
below O
) O
indicates O
that O
the O
user O
is O
male O
, O
was O
born O
on O
25 O
May O
1979 O
, O
and O
works O
for O
the O
'' O
military/police O
'' O
( O
其他- O
军人/警察 O
) O
. O

Because O
of O
all O
this O
we O
consider O
sccm.exe O
as O
an O
unreliable O
indicator O
. O

The O
entry O
costs O
for O
engaging O
in O
malware O
attacks O
in O
a O
conflict O
like O
the O
Syrian O
Civil O
War O
are O
low O
, O
and O
made O
lower O
by O
the O
fact O
that O
the O
rule O
of O
law O
is O
nonexistent O
for O
large O
parts O
of O
the O
country O
. O

However O
, O
we O
note O
that O
the B-Entity
attacker I-Entity
also O
attempts O
to O
social B-Action
engineer I-Action
the B-Entity
identity I-Entity
of I-Entity
individuals I-Entity
working I-Entity
with I-Entity
RSS I-Entity
, O
by O
requesting O
a O
personal O
Facebook O
page O
. O

During O
our O
research O
into O
APT28 O
's O
malware O
, O
we O
noted O
two O
details O
consistent O
across O
malware O
samples O
. O

However O
, O
if O
an O
ad O
library O
uses O
the O
@ O
JavascriptInterface O
annotation O
to O
expose O
security-sensitive O
interfaces O
, O
and O
uses O
HTTP O
to O
load O
content O
in O
the O
WebView O
, O
it O
is O
vulnerable O
to O
attacks O
where O
an B-Entity
attacker I-Entity
over I-Entity
the I-Entity
network I-Entity
could O
inject B-Action
malicious B-Entity
content I-Entity
into B-Modifier
the B-Entity
WebView I-Entity
to B-Modifier
misuse B-Entity
the I-Entity
interfaces I-Entity
exposed I-Entity
through I-Entity
the I-Entity
JS I-Entity
binding I-Entity
annotation I-Entity
. O

Every B-Entity
visitor I-Entity
of I-Entity
the I-Entity
compromised I-Entity
third I-Entity
party I-Entity
is B-Action
then I-Action
infected I-Action
. O

TinyZBot B-Entity
is B-Action
commonly I-Action
installed I-Action
using B-Modifier
some B-Entity
form I-Entity
of I-Entity
deception I-Entity
. O

We O
hope O
that O
you O
have O
a O
look O
at O
it O
with O
them O
and O
inform O
us O
of O
any O
errors O
. O

